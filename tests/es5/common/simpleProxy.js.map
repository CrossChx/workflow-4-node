{"version":3,"sources":["common/simpleProxy.js"],"names":[],"mappings":"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","file":"common/simpleProxy.js","sourcesContent":["\"use strict\";\n/*global describe,it*/\nlet wf4node = require(\"../../../\");\nlet SimpleProxy = wf4node.common.SimpleProxy;\n\nlet assert = require(\"better-assert\");\nlet _ = require(\"lodash\");\n\ndescribe(\"SimpleProxy\", function() {\n    it(\"should work\", function() {\n        let backend = {\n            name: \"Gabor\",\n            getKeys: function(proxy) {\n                return _.keys(this);\n            },\n            getValue: function(proxy, name) {\n                let v = this[name];\n                if (_.isUndefined(v)) {\n                    throw new Error(`${name} doesn't exists.`);\n                }\n                return v;\n            },\n            setValue: function(proxy, name, value) {\n                return this[name] = value;\n            }\n        };\n        let obj = new SimpleProxy(backend);\n\n        obj.foo = \"bar\";\n\n        assert(obj.foo === \"bar\");\n        assert(obj.name === \"Gabor\");\n        try {\n            let x = obj.punci;\n            assert(false);\n        }\n        catch (e) {\n            _.noop(e);\n        }\n        try {\n            obj.punci = 5;\n            assert(false);\n        }\n        catch (e) {\n            _.noop(e);\n        }\n        obj.name = 33;\n        assert(obj.name === 33);\n        assert(backend.name === 33);\n        backend.punci = \"je\";\n        assert(backend.punci === \"je\");\n        obj.update();\n        assert(obj.punci === \"je\");\n\n        let keys = _.keys(obj).sort();\n        assert(keys.length === 3);\n        assert(keys[0] === \"foo\");\n        assert(obj[keys[0]] === \"bar\");\n        assert(keys[1] === \"name\");\n        assert(obj[keys[1]] === 33);\n        assert(keys[2] === \"punci\");\n        assert(obj[keys[2]] === \"je\");\n\n        delete backend.punci;\n        assert(backend.punci === undefined);\n        try {\n            assert(obj.punci === undefined);\n            assert(false);\n        }\n        catch (e) {\n            _.noop(e);\n        }\n\n        obj.update();\n        assert(obj.punci === undefined);\n\n        keys.length = 0;\n        for (let key in obj) {\n            if (obj.hasOwnProperty(key)) {\n                keys.push(key);\n            }\n        }\n        keys.sort();\n        assert(keys.length === 2);\n        assert(keys[0] === \"foo\");\n        assert(obj[keys[0]] === \"bar\");\n        assert(keys[1] === \"name\");\n        assert(obj[keys[1]] === 33);\n    });\n\n    it(\"should accept new props on update\", function() {\n        let backend = {\n            name: \"Gabor\",\n            getKeys: function(proxy) {\n                return _.keys(this);\n            },\n            getValue: function(proxy, name) {\n                let v = this[name];\n                if (_.isUndefined(v)) {\n                    throw new Error(`${name} doesn't exists.`);\n                }\n                return v;\n            },\n            setValue: function(proxy, name, value) {\n                return this[name] = value;\n            }\n        };\n        let obj = new SimpleProxy(backend);\n\n        assert(backend.name === \"Gabor\");\n        assert(obj.name === \"Gabor\");\n\n        obj.klow = \"mudz\";\n\n        assert(obj.klow === \"mudz\");\n        try {\n            assert(backend.klow === \"mudz\");\n            assert(false);\n        }\n        catch (e) {\n            _.noop(e);\n        }\n        obj.update();\n        assert(obj.klow === \"mudz\");\n        assert(backend.klow === \"mudz\");\n\n        // Ensure that the value originates itself from the backend:\n        backend.klow = \"foo\";\n        assert(obj.klow === \"foo\");\n        assert(backend.klow === \"foo\");\n    });\n});"],"sourceRoot":"/source/"}