"use strict";
"use strict";
var wf4node = require("../../../");
var Func = wf4node.activities.Func;
var activityMarkup = wf4node.activities.activityMarkup;
var ActivityExecutionEngine = wf4node.activities.ActivityExecutionEngine;
var assert = require("assert");
var Bluebird = require("bluebird");
var Block = wf4node.activities.Block;
var _ = require("lodash");
describe("objects", function() {
  describe("Merge", function() {
    it("should merge arrays", function(done) {
      var engine = new ActivityExecutionEngine({"@merge": [[1, 2, 3], "# [4, 5, 6]"]});
      engine.invoke().then(function(result) {
        assert(_.isArray(result));
        assert.equal(result.length, 6);
        assert.equal(_(result).sum(), 6 + 5 + 4 + 3 + 2 + 1);
      }).nodeify(done);
    });
    it("should merge objects", function(done) {
      var engine = new ActivityExecutionEngine({"@merge": [{a: function() {
            return 2;
          }}, "# {b: 2}", {c: "function() { return 42; }"}]});
      engine.invoke().then(function(result) {
        assert(_.isObject(result));
        assert.equal(_.keys(result).length, 3);
        assert.equal(result.a, 2);
        assert.equal(result.b, 2);
        assert.equal(result.c, 42);
      }).nodeify(done);
    });
  });
});
//# sourceMappingURL=data:application/json;base64,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ekIsYUFBSyxNQUFNLEFBQUMsQ0FBQyxNQUFLLEVBQUUsQ0FBRyxHQUFDLENBQUMsQ0FBQztNQUM5QixDQUFDLFFBQVEsQUFBQyxDQUFDLElBQUcsQ0FBQyxDQUFDO0lBQ3hCLENBQUMsQ0FBQztFQUNOLENBQUMsQ0FBQztBQUNOLENBQUMsQ0FBQztBQUFBIiwiZmlsZSI6ImFjdGl2aXRpZXMvb2JqZWN0cy5qcyIsInNvdXJjZVJvb3QiOiJ0ZXN0cy9lczYiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuLyogZ2xvYmFsIGRlc2NyaWJlLGl0ICovXG5cbmxldCB3ZjRub2RlID0gcmVxdWlyZShcIi4uLy4uLy4uL1wiKTtcbmxldCBGdW5jID0gd2Y0bm9kZS5hY3Rpdml0aWVzLkZ1bmM7XG5sZXQgYWN0aXZpdHlNYXJrdXAgPSB3ZjRub2RlLmFjdGl2aXRpZXMuYWN0aXZpdHlNYXJrdXA7XG5sZXQgQWN0aXZpdHlFeGVjdXRpb25FbmdpbmUgPSB3ZjRub2RlLmFjdGl2aXRpZXMuQWN0aXZpdHlFeGVjdXRpb25FbmdpbmU7XG5sZXQgYXNzZXJ0ID0gcmVxdWlyZShcImFzc2VydFwiKTtcbmxldCBCbHVlYmlyZCA9IHJlcXVpcmUoXCJibHVlYmlyZFwiKTtcbmxldCBCbG9jayA9IHdmNG5vZGUuYWN0aXZpdGllcy5CbG9jaztcbmxldCBfID0gcmVxdWlyZShcImxvZGFzaFwiKTtcblxuZGVzY3JpYmUoXCJvYmplY3RzXCIsIGZ1bmN0aW9uKCkge1xuICAgIGRlc2NyaWJlKFwiTWVyZ2VcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICBpdChcInNob3VsZCBtZXJnZSBhcnJheXNcIiwgZnVuY3Rpb24gKGRvbmUpIHtcbiAgICAgICAgICAgIGxldCBlbmdpbmUgPSBuZXcgQWN0aXZpdHlFeGVjdXRpb25FbmdpbmUoe1xuICAgICAgICAgICAgICAgIFwiQG1lcmdlXCI6IFtcbiAgICAgICAgICAgICAgICAgICAgWzEsIDIsIDNdLFxuICAgICAgICAgICAgICAgICAgICBcIiMgWzQsIDUsIDZdXCJcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZW5naW5lLmludm9rZSgpLnRoZW4oXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQoXy5pc0FycmF5KHJlc3VsdCkpO1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQuZXF1YWwocmVzdWx0Lmxlbmd0aCwgNik7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydC5lcXVhbChfKHJlc3VsdCkuc3VtKCksIDYgKyA1ICsgNCArIDMgKyAyICsgMSk7XG4gICAgICAgICAgICAgICAgfSkubm9kZWlmeShkb25lKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJzaG91bGQgbWVyZ2Ugb2JqZWN0c1wiLCBmdW5jdGlvbiAoZG9uZSkge1xuICAgICAgICAgICAgbGV0IGVuZ2luZSA9IG5ldyBBY3Rpdml0eUV4ZWN1dGlvbkVuZ2luZSh7XG4gICAgICAgICAgICAgICAgXCJAbWVyZ2VcIjogW1xuICAgICAgICAgICAgICAgICAgICB7IGE6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIDI7IH0gfSxcbiAgICAgICAgICAgICAgICAgICAgXCIjIHtiOiAyfVwiLFxuICAgICAgICAgICAgICAgICAgICB7IGM6IFwiZnVuY3Rpb24oKSB7IHJldHVybiA0MjsgfVwiIH1cbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZW5naW5lLmludm9rZSgpLnRoZW4oXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQoXy5pc09iamVjdChyZXN1bHQpKTtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0LmVxdWFsKF8ua2V5cyhyZXN1bHQpLmxlbmd0aCwgMyk7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydC5lcXVhbChyZXN1bHQuYSwgMik7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydC5lcXVhbChyZXN1bHQuYiwgMik7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydC5lcXVhbChyZXN1bHQuYywgNDIpO1xuICAgICAgICAgICAgICAgIH0pLm5vZGVpZnkoZG9uZSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSk7Il19
