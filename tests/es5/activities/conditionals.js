"use strict";
var wf4node = require("../../../");
var Func = wf4node.activities.Func;
var activityMarkup = wf4node.activities.activityMarkup;
var ActivityExecutionEngine = wf4node.activities.ActivityExecutionEngine;
var assert = require("assert");
var Bluebird = require("bluebird");
var Block = wf4node.activities.Block;
var _ = require("lodash");
describe("conditionals", function() {
  describe("If", function() {
    it("should call then", function(done) {
      var block = activityMarkup.parse({"@block": {
          v: 5,
          args: [{"@if": {
              condition: "= this.v == 5",
              then: {"@func": {
                  args: [1],
                  code: function(a) {
                    return a + this.v;
                  }
                }},
              else: {"@func": {
                  args: [2],
                  code: function(a) {
                    return a + this.v;
                  }
                }}
            }}]
        }});
      var engine = new ActivityExecutionEngine(block);
      engine.invoke().then(function(result) {
        assert.equal(result, 1 + 5);
      }).nodeify(done);
    });
    it("should call else", function(done) {
      var block = activityMarkup.parse({"@block": {
          v: 5,
          r: 0,
          args: [{"@if": {
              condition: {"@func": {code: function() {
                    return false;
                  }}},
              then: {"@func": {
                  args: [1],
                  code: function(a) {
                    this.r = a + this.v;
                  }
                }},
              else: {"@func": {
                  args: [2],
                  code: function(a) {
                    this.r = a + this.v;
                  }
                }}
            }}, "= this.r"]
        }});
      var engine = new ActivityExecutionEngine(block);
      engine.invoke().then(function(result) {
        assert.equal(result, 2 + 5);
      }).nodeify(done);
    });
    it("should run blocks", function(done) {
      var block = activityMarkup.parse({"@block": {
          v: 5,
          s: 1,
          args: [{"@if": {
              condition: {"@func": {code: function() {
                    return false;
                  }}},
              then: {"@func": {
                  args: [1],
                  code: function(a) {
                    this.s = a + this.v;
                  }
                }},
              else: {"@block": [{"@func": {
                    args: [2],
                    code: function(a) {
                      var self = this;
                      return Bluebird.delay(100).then(function() {
                        self.s = 40 + a;
                      });
                    }
                  }}, function() {
                  return this.s;
                }]}
            }}, "= this.s"]
        }});
      var engine = new ActivityExecutionEngine(block);
      engine.invoke().then(function(result) {
        assert.equal(result, 42);
      }).nodeify(done);
    });
    it("then should be a block", function(done) {
      var block = activityMarkup.parse({"@block": {
          v: 5,
          args: [{"@if": {
              condition: "= this.v == 5",
              then: [5, function() {
                var self = this;
                return Bluebird.delay(100).then(function() {
                  self.v = 7;
                });
              }, "= this.v "]
            }}]
        }});
      var engine = new ActivityExecutionEngine(block);
      engine.invoke().then(function(result) {
        assert.equal(7, result);
      }).nodeify(done);
    });
    it("else should be a block", function(done) {
      var block = activityMarkup.parse({"@block": {
          v: 1,
          args: [{"@if": {
              condition: "= this.v == 5",
              then: [1, 2],
              else: [5, function() {
                this.v = 7;
              }, "= this.v"]
            }}]
        }});
      var engine = new ActivityExecutionEngine(block);
      engine.invoke().then(function(result) {
        assert.equal(7, result);
      }).nodeify(done);
    });
  });
  describe("Switch", function() {
    describe("switch w/ case", function() {
      it("should work w/o default", function(done) {
        var engine = new ActivityExecutionEngine({"@switch": {
            expression: "= 42",
            args: [{"@case": {
                value: 43,
                args: function() {
                  return "55";
                }
              }}, {"@case": {
                value: 42,
                args: function() {
                  return "hi";
                }
              }}, {"@case": {
                value: "42",
                args: "= 'boo'"
              }}]
          }});
        engine.invoke().then(function(result) {
          assert.deepEqual(result, "hi");
        }).nodeify(done);
      });
      it("should work w default", function(done) {
        var engine = new ActivityExecutionEngine({"@switch": {
            expression: "= 43",
            args: [{"@case": {
                value: 43,
                args: function() {
                  return 55;
                }
              }}, {"@case": {
                value: 42,
                args: function() {
                  return "hi";
                }
              }}, {"@default": "= 'boo'"}]
          }});
        engine.invoke().then(function(result) {
          assert.deepEqual(result, 55);
        }).nodeify(done);
      });
      it("should do its default", function(done) {
        var engine = new ActivityExecutionEngine({"@switch": {
            expression: "= 'klow'",
            args: [{"@case": {
                value: 43,
                args: function() {
                  return 55;
                }
              }}, {"@case": {
                value: 42,
                args: function() {
                  return "hi";
                }
              }}, {"@default": "= 'boo'"}]
          }});
        engine.invoke().then(function(result) {
          assert.deepEqual(result, "boo");
        }).nodeify(done);
      });
    });
    describe("switch w/ when", function() {
      it("should work w/o default", function(done) {
        var engine = new ActivityExecutionEngine({"@switch": {args: [{"@when": {
                condition: 0,
                args: function() {
                  return "55";
                }
              }}, {"@when": {
                condition: function() {
                  return Bluebird.resolve(42);
                },
                args: function() {
                  return "hi";
                }
              }}, {"@when": {
                condition: "42",
                args: "= 'boo'"
              }}]}});
        engine.invoke().then(function(result) {
          assert.deepEqual(result, "hi");
        }).nodeify(done);
      });
      it("should work w default", function(done) {
        var engine = new ActivityExecutionEngine({"@switch": {args: [{"@when": {
                condition: 43,
                args: function() {
                  return 55;
                }
              }}, {"@when": {
                condition: undefined,
                args: function() {
                  return "hi";
                }
              }}, {"@default": "= 'boo'"}]}});
        engine.invoke().then(function(result) {
          assert.deepEqual(result, 55);
        }).nodeify(done);
      });
      it("should do its default", function(done) {
        var engine = new ActivityExecutionEngine({"@switch": {args: [{"@when": {
                condition: "",
                args: function() {
                  return 55;
                }
              }}, {"@when": {
                condition: null,
                args: function() {
                  return "hi";
                }
              }}, {"@default": "= 'boo'"}]}});
        engine.invoke().then(function(result) {
          assert.deepEqual(result, "boo");
        }).nodeify(done);
      });
    });
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbmRpdGlvbmFscy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUlBLEFBQUksRUFBQSxDQUFBLE9BQU0sRUFBSSxDQUFBLE9BQU0sQUFBQyxDQUFDLFdBQVUsQ0FBQyxDQUFDO0FBQ2xDLEFBQUksRUFBQSxDQUFBLElBQUcsRUFBSSxDQUFBLE9BQU0sV0FBVyxLQUFLLENBQUM7QUFDbEMsQUFBSSxFQUFBLENBQUEsY0FBYSxFQUFJLENBQUEsT0FBTSxXQUFXLGVBQWUsQ0FBQztBQUN0RCxBQUFJLEVBQUEsQ0FBQSx1QkFBc0IsRUFBSSxDQUFBLE9BQU0sV0FBVyx3QkFBd0IsQ0FBQztBQUN4RSxBQUFJLEVBQUEsQ0FBQSxNQUFLLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxRQUFPLENBQUMsQ0FBQztBQUM5QixBQUFJLEVBQUEsQ0FBQSxRQUFPLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxVQUFTLENBQUMsQ0FBQztBQUNsQyxBQUFJLEVBQUEsQ0FBQSxLQUFJLEVBQUksQ0FBQSxPQUFNLFdBQVcsTUFBTSxDQUFDO0FBQ3BDLEFBQUksRUFBQSxDQUFBLENBQUEsRUFBSSxDQUFBLE9BQU0sQUFBQyxDQUFDLFFBQU8sQ0FBQyxDQUFDO0FBRXpCLE9BQU8sQUFBQyxDQUFDLGNBQWEsQ0FBRyxVQUFVLEFBQUQsQ0FBRztBQUNqQyxTQUFPLEFBQUMsQ0FBQyxJQUFHLENBQUcsVUFBVSxBQUFELENBQUc7QUFDdkIsS0FBQyxBQUFDLENBQUMsa0JBQWlCLENBQUcsVUFBVSxJQUFHLENBQUc7QUFDbkMsQUFBSSxRQUFBLENBQUEsS0FBSSxFQUFJLENBQUEsY0FBYSxNQUFNLEFBQUMsQ0FBQyxDQUM3QixRQUFPLENBQUc7QUFDTixVQUFBLENBQUcsRUFBQTtBQUNILGFBQUcsQ0FBRyxFQUNGLENBQ0ksS0FBSSxDQUFHO0FBQ0gsc0JBQVEsQ0FBRyxnQkFBYztBQUN6QixpQkFBRyxDQUFHLEVBQ0YsT0FBTSxDQUFHO0FBQ0wscUJBQUcsQ0FBRyxFQUFDLENBQUEsQ0FBQztBQUNSLHFCQUFHLENBQUcsVUFBVSxDQUFBLENBQUc7QUFDZix5QkFBTyxDQUFBLENBQUEsRUFBSSxDQUFBLElBQUcsRUFBRSxDQUFDO2tCQUNyQjtBQUFBLGdCQUNKLENBQ0o7QUFDQSxpQkFBRyxDQUFHLEVBQ0YsT0FBTSxDQUFHO0FBQ0wscUJBQUcsQ0FBRyxFQUFDLENBQUEsQ0FBQztBQUNSLHFCQUFHLENBQUcsVUFBVSxDQUFBLENBQUc7QUFDZix5QkFBTyxDQUFBLENBQUEsRUFBSSxDQUFBLElBQUcsRUFBRSxDQUFDO2tCQUNyQjtBQUFBLGdCQUNKLENBQ0o7QUFBQSxZQUNKLENBQ0osQ0FDSjtBQUFBLFFBQ0osQ0FDSixDQUFDLENBQUM7QUFFRixBQUFJLFFBQUEsQ0FBQSxNQUFLLEVBQUksSUFBSSx3QkFBc0IsQUFBQyxDQUFDLEtBQUksQ0FBQyxDQUFDO0FBQy9DLFdBQUssT0FBTyxBQUFDLEVBQUMsS0FBSyxBQUFDLENBQ2hCLFNBQVUsTUFBSyxDQUFHO0FBQ2QsYUFBSyxNQUFNLEFBQUMsQ0FBQyxNQUFLLENBQUcsQ0FBQSxDQUFBLEVBQUksRUFBQSxDQUFDLENBQUM7TUFDL0IsQ0FBQyxRQUFRLEFBQUMsQ0FBQyxJQUFHLENBQUMsQ0FBQztJQUN4QixDQUFDLENBQUM7QUFFRixLQUFDLEFBQUMsQ0FBQyxrQkFBaUIsQ0FBRyxVQUFVLElBQUcsQ0FBRztBQUNuQyxBQUFJLFFBQUEsQ0FBQSxLQUFJLEVBQUksQ0FBQSxjQUFhLE1BQU0sQUFBQyxDQUFDLENBQzdCLFFBQU8sQ0FBRztBQUNOLFVBQUEsQ0FBRyxFQUFBO0FBQ0gsVUFBQSxDQUFHLEVBQUE7QUFDSCxhQUFHLENBQUcsRUFDRixDQUNJLEtBQUksQ0FBRztBQUNILHNCQUFRLENBQUcsRUFDUCxPQUFNLENBQUcsRUFDTCxJQUFHLENBQUcsVUFBVSxBQUFELENBQUc7QUFDZCx5QkFBTyxNQUFJLENBQUM7a0JBQ2hCLENBQ0osQ0FDSjtBQUNBLGlCQUFHLENBQUcsRUFDRixPQUFNLENBQUc7QUFDTCxxQkFBRyxDQUFHLEVBQUMsQ0FBQSxDQUFDO0FBQ1IscUJBQUcsQ0FBRyxVQUFVLENBQUEsQ0FBRztBQUNmLHVCQUFHLEVBQUUsRUFBSSxDQUFBLENBQUEsRUFBSSxDQUFBLElBQUcsRUFBRSxDQUFDO2tCQUN2QjtBQUFBLGdCQUNKLENBQ0o7QUFDQSxpQkFBRyxDQUFHLEVBQ0YsT0FBTSxDQUFHO0FBQ0wscUJBQUcsQ0FBRyxFQUFDLENBQUEsQ0FBQztBQUNSLHFCQUFHLENBQUcsVUFBVSxDQUFBLENBQUc7QUFDZix1QkFBRyxFQUFFLEVBQUksQ0FBQSxDQUFBLEVBQUksQ0FBQSxJQUFHLEVBQUUsQ0FBQztrQkFDdkI7QUFBQSxnQkFDSixDQUNKO0FBQUEsWUFDSixDQUNKLENBQ0EsV0FBUyxDQUNiO0FBQUEsUUFDSixDQUNKLENBQUMsQ0FBQztBQUVGLEFBQUksUUFBQSxDQUFBLE1BQUssRUFBSSxJQUFJLHdCQUFzQixBQUFDLENBQUMsS0FBSSxDQUFDLENBQUM7QUFDL0MsV0FBSyxPQUFPLEFBQUMsRUFBQyxLQUFLLEFBQUMsQ0FDaEIsU0FBVSxNQUFLLENBQUc7QUFDZCxhQUFLLE1BQU0sQUFBQyxDQUFDLE1BQUssQ0FBRyxDQUFBLENBQUEsRUFBSSxFQUFBLENBQUMsQ0FBQztNQUMvQixDQUFDLFFBQVEsQUFBQyxDQUFDLElBQUcsQ0FBQyxDQUFDO0lBQ3hCLENBQUMsQ0FBQztBQUVGLEtBQUMsQUFBQyxDQUFDLG1CQUFrQixDQUFHLFVBQVUsSUFBRyxDQUFHO0FBQ3BDLEFBQUksUUFBQSxDQUFBLEtBQUksRUFBSSxDQUFBLGNBQWEsTUFBTSxBQUFDLENBQUMsQ0FDN0IsUUFBTyxDQUFHO0FBQ04sVUFBQSxDQUFHLEVBQUE7QUFDSCxVQUFBLENBQUcsRUFBQTtBQUNILGFBQUcsQ0FBRyxFQUNGLENBQ0ksS0FBSSxDQUFHO0FBQ0gsc0JBQVEsQ0FBRyxFQUNQLE9BQU0sQ0FBRyxFQUNMLElBQUcsQ0FBRyxVQUFVLEFBQUQsQ0FBRztBQUNkLHlCQUFPLE1BQUksQ0FBQztrQkFDaEIsQ0FDSixDQUNKO0FBQ0EsaUJBQUcsQ0FBRyxFQUNGLE9BQU0sQ0FBRztBQUNMLHFCQUFHLENBQUcsRUFBQyxDQUFBLENBQUM7QUFDUixxQkFBRyxDQUFHLFVBQVUsQ0FBQSxDQUFHO0FBQ2YsdUJBQUcsRUFBRSxFQUFJLENBQUEsQ0FBQSxFQUFJLENBQUEsSUFBRyxFQUFFLENBQUM7a0JBQ3ZCO0FBQUEsZ0JBQ0osQ0FDSjtBQUNBLGlCQUFHLENBQUcsRUFDRixRQUFPLENBQUcsRUFDTixDQUNJLE9BQU0sQ0FBRztBQUNMLHVCQUFHLENBQUcsRUFBQyxDQUFBLENBQUM7QUFDUix1QkFBRyxDQUFHLFVBQVUsQ0FBQSxDQUFHO0FBQ2YsQUFBSSx3QkFBQSxDQUFBLElBQUcsRUFBSSxLQUFHLENBQUM7QUFDZiwyQkFBTyxDQUFBLFFBQU8sTUFBTSxBQUFDLENBQUMsR0FBRSxDQUFDLEtBQUssQUFBQyxDQUFDLFNBQVUsQUFBRCxDQUFHO0FBQUUsMkJBQUcsRUFBRSxFQUFJLENBQUEsRUFBQyxFQUFJLEVBQUEsQ0FBQztzQkFBRSxDQUFDLENBQUM7b0JBQ3JFO0FBQUEsa0JBQ0osQ0FDSixDQUNBLFVBQVUsQUFBRCxDQUFHO0FBQ1IsdUJBQU8sQ0FBQSxJQUFHLEVBQUUsQ0FBQztnQkFDakIsQ0FDSixDQUNKO0FBQUEsWUFDSixDQUNKLENBQ0EsV0FBUyxDQUNiO0FBQUEsUUFDSixDQUNKLENBQUMsQ0FBQztBQUVGLEFBQUksUUFBQSxDQUFBLE1BQUssRUFBSSxJQUFJLHdCQUFzQixBQUFDLENBQUMsS0FBSSxDQUFDLENBQUM7QUFDL0MsV0FBSyxPQUFPLEFBQUMsRUFBQyxLQUFLLEFBQUMsQ0FDaEIsU0FBVSxNQUFLLENBQUc7QUFDZCxhQUFLLE1BQU0sQUFBQyxDQUFDLE1BQUssQ0FBRyxHQUFDLENBQUMsQ0FBQztNQUM1QixDQUFDLFFBQVEsQUFBQyxDQUFDLElBQUcsQ0FBQyxDQUFDO0lBQ3hCLENBQUMsQ0FBQztBQUVGLEtBQUMsQUFBQyxDQUFDLHdCQUF1QixDQUFHLFVBQVUsSUFBRyxDQUFHO0FBQ3pDLEFBQUksUUFBQSxDQUFBLEtBQUksRUFBSSxDQUFBLGNBQWEsTUFBTSxBQUFDLENBQUMsQ0FDN0IsUUFBTyxDQUFHO0FBQ04sVUFBQSxDQUFHLEVBQUE7QUFDSCxhQUFHLENBQUcsRUFDRixDQUNJLEtBQUksQ0FBRztBQUNILHNCQUFRLENBQUcsZ0JBQWM7QUFDekIsaUJBQUcsQ0FBRyxFQUNGLENBQUEsQ0FDQSxVQUFVLEFBQUQsQ0FBRztBQUNSLEFBQUksa0JBQUEsQ0FBQSxJQUFHLEVBQUksS0FBRyxDQUFDO0FBQ2YscUJBQU8sQ0FBQSxRQUFPLE1BQU0sQUFBQyxDQUFDLEdBQUUsQ0FBQyxLQUNqQixBQUFDLENBQUMsU0FBVSxBQUFELENBQUc7QUFDZCxxQkFBRyxFQUFFLEVBQUksRUFBQSxDQUFDO2dCQUNkLENBQUMsQ0FBQztjQUNWLENBQ0EsWUFBVSxDQUNkO0FBQUEsWUFDSixDQUNKLENBQ0o7QUFBQSxRQUNKLENBQ0osQ0FBQyxDQUFDO0FBRUYsQUFBSSxRQUFBLENBQUEsTUFBSyxFQUFJLElBQUksd0JBQXNCLEFBQUMsQ0FBQyxLQUFJLENBQUMsQ0FBQztBQUMvQyxXQUFLLE9BQU8sQUFBQyxFQUFDLEtBQUssQUFBQyxDQUNoQixTQUFVLE1BQUssQ0FBRztBQUNkLGFBQUssTUFBTSxBQUFDLENBQUMsQ0FBQSxDQUFHLE9BQUssQ0FBQyxDQUFDO01BQzNCLENBQUMsUUFBUSxBQUFDLENBQUMsSUFBRyxDQUFDLENBQUM7SUFDeEIsQ0FBQyxDQUFDO0FBRUYsS0FBQyxBQUFDLENBQUMsd0JBQXVCLENBQUcsVUFBVSxJQUFHLENBQUc7QUFDekMsQUFBSSxRQUFBLENBQUEsS0FBSSxFQUFJLENBQUEsY0FBYSxNQUFNLEFBQUMsQ0FBQyxDQUM3QixRQUFPLENBQUc7QUFDTixVQUFBLENBQUcsRUFBQTtBQUNILGFBQUcsQ0FBRyxFQUNGLENBQ0ksS0FBSSxDQUFHO0FBQ0gsc0JBQVEsQ0FBRyxnQkFBYztBQUN6QixpQkFBRyxDQUFHLEVBQUMsQ0FBQSxDQUFHLEVBQUEsQ0FBQztBQUNYLGlCQUFHLENBQUcsRUFDRixDQUFBLENBQUcsVUFBVSxBQUFELENBQUc7QUFBRSxtQkFBRyxFQUFFLEVBQUksRUFBQSxDQUFDO2NBQUUsQ0FBRyxXQUFTLENBQzdDO0FBQUEsWUFDSixDQUNKLENBQ0o7QUFBQSxRQUNKLENBQ0osQ0FBQyxDQUFDO0FBRUYsQUFBSSxRQUFBLENBQUEsTUFBSyxFQUFJLElBQUksd0JBQXNCLEFBQUMsQ0FBQyxLQUFJLENBQUMsQ0FBQztBQUMvQyxXQUFLLE9BQU8sQUFBQyxFQUFDLEtBQUssQUFBQyxDQUNoQixTQUFVLE1BQUssQ0FBRztBQUNkLGFBQUssTUFBTSxBQUFDLENBQUMsQ0FBQSxDQUFHLE9BQUssQ0FBQyxDQUFDO01BQzNCLENBQUMsUUFBUSxBQUFDLENBQUMsSUFBRyxDQUFDLENBQUM7SUFDeEIsQ0FBQyxDQUFDO0VBQ04sQ0FBQyxDQUFDO0FBRUYsU0FBTyxBQUFDLENBQUMsUUFBTyxDQUFHLFVBQVUsQUFBRCxDQUFHO0FBQzNCLFdBQU8sQUFBQyxDQUFDLGdCQUFlLENBQUcsVUFBVSxBQUFELENBQUc7QUFDbkMsT0FBQyxBQUFDLENBQUMseUJBQXdCLENBQUcsVUFBVSxJQUFHLENBQUc7QUFDMUMsQUFBSSxVQUFBLENBQUEsTUFBSyxFQUFJLElBQUksd0JBQXNCLEFBQUMsQ0FBQyxDQUNyQyxTQUFRLENBQUc7QUFDUCxxQkFBUyxDQUFHLE9BQUs7QUFDakIsZUFBRyxDQUFHLEVBQ0YsQ0FDSSxPQUFNLENBQUc7QUFDTCxvQkFBSSxDQUFHLEdBQUM7QUFDUixtQkFBRyxDQUFHLFVBQVUsQUFBRCxDQUFHO0FBQ2QsdUJBQU8sS0FBRyxDQUFDO2dCQUNmO0FBQUEsY0FDSixDQUNKLENBQ0EsRUFDSSxPQUFNLENBQUc7QUFDTCxvQkFBSSxDQUFHLEdBQUM7QUFDUixtQkFBRyxDQUFHLFVBQVUsQUFBRCxDQUFHO0FBQ2QsdUJBQU8sS0FBRyxDQUFDO2dCQUNmO0FBQUEsY0FDSixDQUNKLENBQ0EsRUFDSSxPQUFNLENBQUc7QUFDTCxvQkFBSSxDQUFHLEtBQUc7QUFDVixtQkFBRyxDQUFHLFVBQVE7QUFBQSxjQUNsQixDQUNKLENBQ0o7QUFBQSxVQUNKLENBQ0osQ0FBQyxDQUFDO0FBRUYsYUFBSyxPQUFPLEFBQUMsRUFBQyxLQUFLLEFBQUMsQ0FDaEIsU0FBVSxNQUFLLENBQUc7QUFDZCxlQUFLLFVBQVUsQUFBQyxDQUFDLE1BQUssQ0FBRyxLQUFHLENBQUMsQ0FBQztRQUNsQyxDQUFDLFFBQVEsQUFBQyxDQUFDLElBQUcsQ0FBQyxDQUFDO01BQ3hCLENBQUMsQ0FBQztBQUVGLE9BQUMsQUFBQyxDQUFDLHVCQUFzQixDQUFHLFVBQVUsSUFBRyxDQUFHO0FBQ3hDLEFBQUksVUFBQSxDQUFBLE1BQUssRUFBSSxJQUFJLHdCQUFzQixBQUFDLENBQUMsQ0FDckMsU0FBUSxDQUFHO0FBQ1AscUJBQVMsQ0FBRyxPQUFLO0FBQ2pCLGVBQUcsQ0FBRyxFQUNGLENBQ0ksT0FBTSxDQUFHO0FBQ0wsb0JBQUksQ0FBRyxHQUFDO0FBQ1IsbUJBQUcsQ0FBRyxVQUFVLEFBQUQsQ0FBRztBQUNkLHVCQUFPLEdBQUMsQ0FBQztnQkFDYjtBQUFBLGNBQ0osQ0FDSixDQUNBLEVBQ0ksT0FBTSxDQUFHO0FBQ0wsb0JBQUksQ0FBRyxHQUFDO0FBQ1IsbUJBQUcsQ0FBRyxVQUFVLEFBQUQsQ0FBRztBQUNkLHVCQUFPLEtBQUcsQ0FBQztnQkFDZjtBQUFBLGNBQ0osQ0FDSixDQUNBLEVBQ0ksVUFBUyxDQUFHLFVBQVEsQ0FDeEIsQ0FDSjtBQUFBLFVBQ0osQ0FDSixDQUFDLENBQUM7QUFFRixhQUFLLE9BQU8sQUFBQyxFQUFDLEtBQUssQUFBQyxDQUNoQixTQUFVLE1BQUssQ0FBRztBQUNkLGVBQUssVUFBVSxBQUFDLENBQUMsTUFBSyxDQUFHLEdBQUMsQ0FBQyxDQUFDO1FBQ2hDLENBQUMsUUFBUSxBQUFDLENBQUMsSUFBRyxDQUFDLENBQUM7TUFDeEIsQ0FBQyxDQUFDO0FBRUYsT0FBQyxBQUFDLENBQUMsdUJBQXNCLENBQUcsVUFBVSxJQUFHLENBQUc7QUFDeEMsQUFBSSxVQUFBLENBQUEsTUFBSyxFQUFJLElBQUksd0JBQXNCLEFBQUMsQ0FBQyxDQUNyQyxTQUFRLENBQUc7QUFDUCxxQkFBUyxDQUFHLFdBQVM7QUFDckIsZUFBRyxDQUFHLEVBQ0YsQ0FDSSxPQUFNLENBQUc7QUFDTCxvQkFBSSxDQUFHLEdBQUM7QUFDUixtQkFBRyxDQUFHLFVBQVUsQUFBRCxDQUFHO0FBQ2QsdUJBQU8sR0FBQyxDQUFDO2dCQUNiO0FBQUEsY0FDSixDQUNKLENBQ0EsRUFDSSxPQUFNLENBQUc7QUFDTCxvQkFBSSxDQUFHLEdBQUM7QUFDUixtQkFBRyxDQUFHLFVBQVUsQUFBRCxDQUFHO0FBQ2QsdUJBQU8sS0FBRyxDQUFDO2dCQUNmO0FBQUEsY0FDSixDQUNKLENBQ0EsRUFDSSxVQUFTLENBQUcsVUFBUSxDQUN4QixDQUNKO0FBQUEsVUFDSixDQUNKLENBQUMsQ0FBQztBQUVGLGFBQUssT0FBTyxBQUFDLEVBQUMsS0FBSyxBQUFDLENBQ2hCLFNBQVUsTUFBSyxDQUFHO0FBQ2QsZUFBSyxVQUFVLEFBQUMsQ0FBQyxNQUFLLENBQUcsTUFBSSxDQUFDLENBQUM7UUFDbkMsQ0FBQyxRQUFRLEFBQUMsQ0FBQyxJQUFHLENBQUMsQ0FBQztNQUN4QixDQUFDLENBQUM7SUFDTixDQUFDLENBQUM7QUFFRixXQUFPLEFBQUMsQ0FBQyxnQkFBZSxDQUFHLFVBQVUsQUFBRCxDQUFHO0FBQ25DLE9BQUMsQUFBQyxDQUFDLHlCQUF3QixDQUFHLFVBQVUsSUFBRyxDQUFHO0FBQzFDLEFBQUksVUFBQSxDQUFBLE1BQUssRUFBSSxJQUFJLHdCQUFzQixBQUFDLENBQUMsQ0FDckMsU0FBUSxDQUFHLEVBQ1AsSUFBRyxDQUFHLEVBQ0YsQ0FDSSxPQUFNLENBQUc7QUFDTCx3QkFBUSxDQUFHLEVBQUE7QUFDWCxtQkFBRyxDQUFHLFVBQVUsQUFBRCxDQUFHO0FBQ2QsdUJBQU8sS0FBRyxDQUFDO2dCQUNmO0FBQUEsY0FDSixDQUNKLENBQ0EsRUFDSSxPQUFNLENBQUc7QUFDTCx3QkFBUSxDQUFHLFVBQVUsQUFBRCxDQUFHO0FBQ25CLHVCQUFPLENBQUEsUUFBTyxRQUFRLEFBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQztnQkFDL0I7QUFDQSxtQkFBRyxDQUFHLFVBQVUsQUFBRCxDQUFHO0FBQ2QsdUJBQU8sS0FBRyxDQUFDO2dCQUNmO0FBQUEsY0FDSixDQUNKLENBQ0EsRUFDSSxPQUFNLENBQUc7QUFDTCx3QkFBUSxDQUFHLEtBQUc7QUFDZCxtQkFBRyxDQUFHLFVBQVE7QUFBQSxjQUNsQixDQUNKLENBQ0osQ0FDSixDQUNKLENBQUMsQ0FBQztBQUVGLGFBQUssT0FBTyxBQUFDLEVBQUMsS0FBSyxBQUFDLENBQ2hCLFNBQVUsTUFBSyxDQUFHO0FBQ2QsZUFBSyxVQUFVLEFBQUMsQ0FBQyxNQUFLLENBQUcsS0FBRyxDQUFDLENBQUM7UUFDbEMsQ0FBQyxRQUFRLEFBQUMsQ0FBQyxJQUFHLENBQUMsQ0FBQztNQUN4QixDQUFDLENBQUM7QUFFRixPQUFDLEFBQUMsQ0FBQyx1QkFBc0IsQ0FBRyxVQUFVLElBQUcsQ0FBRztBQUN4QyxBQUFJLFVBQUEsQ0FBQSxNQUFLLEVBQUksSUFBSSx3QkFBc0IsQUFBQyxDQUFDLENBQ3JDLFNBQVEsQ0FBRyxFQUNQLElBQUcsQ0FBRyxFQUNGLENBQ0ksT0FBTSxDQUFHO0FBQ0wsd0JBQVEsQ0FBRyxHQUFDO0FBQ1osbUJBQUcsQ0FBRyxVQUFVLEFBQUQsQ0FBRztBQUNkLHVCQUFPLEdBQUMsQ0FBQztnQkFDYjtBQUFBLGNBQ0osQ0FDSixDQUNBLEVBQ0ksT0FBTSxDQUFHO0FBQ0wsd0JBQVEsQ0FBRyxVQUFRO0FBQ25CLG1CQUFHLENBQUcsVUFBVSxBQUFELENBQUc7QUFDZCx1QkFBTyxLQUFHLENBQUM7Z0JBQ2Y7QUFBQSxjQUNKLENBQ0osQ0FDQSxFQUNJLFVBQVMsQ0FBRyxVQUFRLENBQ3hCLENBQ0osQ0FDSixDQUNKLENBQUMsQ0FBQztBQUlGLGFBQUssT0FBTyxBQUFDLEVBQUMsS0FBSyxBQUFDLENBQ2hCLFNBQVUsTUFBSyxDQUFHO0FBQ2QsZUFBSyxVQUFVLEFBQUMsQ0FBQyxNQUFLLENBQUcsR0FBQyxDQUFDLENBQUM7UUFDaEMsQ0FBQyxRQUFRLEFBQUMsQ0FBQyxJQUFHLENBQUMsQ0FBQztNQUN4QixDQUFDLENBQUM7QUFFRixPQUFDLEFBQUMsQ0FBQyx1QkFBc0IsQ0FBRyxVQUFVLElBQUcsQ0FBRztBQUN4QyxBQUFJLFVBQUEsQ0FBQSxNQUFLLEVBQUksSUFBSSx3QkFBc0IsQUFBQyxDQUFDLENBQ3JDLFNBQVEsQ0FBRyxFQUNQLElBQUcsQ0FBRyxFQUNGLENBQ0ksT0FBTSxDQUFHO0FBQ0wsd0JBQVEsQ0FBRyxHQUFDO0FBQ1osbUJBQUcsQ0FBRyxVQUFVLEFBQUQsQ0FBRztBQUNkLHVCQUFPLEdBQUMsQ0FBQztnQkFDYjtBQUFBLGNBQ0osQ0FDSixDQUNBLEVBQ0ksT0FBTSxDQUFHO0FBQ0wsd0JBQVEsQ0FBRyxLQUFHO0FBQ2QsbUJBQUcsQ0FBRyxVQUFVLEFBQUQsQ0FBRztBQUNkLHVCQUFPLEtBQUcsQ0FBQztnQkFDZjtBQUFBLGNBQ0osQ0FDSixDQUNBLEVBQ0ksVUFBUyxDQUFHLFVBQVEsQ0FDeEIsQ0FDSixDQUNKLENBQ0osQ0FBQyxDQUFDO0FBRUYsYUFBSyxPQUFPLEFBQUMsRUFBQyxLQUFLLEFBQUMsQ0FDaEIsU0FBVSxNQUFLLENBQUc7QUFDZCxlQUFLLFVBQVUsQUFBQyxDQUFDLE1BQUssQ0FBRyxNQUFJLENBQUMsQ0FBQztRQUNuQyxDQUFDLFFBQVEsQUFBQyxDQUFDLElBQUcsQ0FBQyxDQUFDO01BQ3hCLENBQUMsQ0FBQztJQUNOLENBQUMsQ0FBQztFQUNOLENBQUMsQ0FBQztBQUNOLENBQUMsQ0FBQztBQUFBIiwiZmlsZSI6ImFjdGl2aXRpZXMvY29uZGl0aW9uYWxzLmpzIiwic291cmNlUm9vdCI6InRlc3RzL2VzNiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG4vKiBnbG9iYWwgZGVzY3JpYmUsaXQgKi9cblxubGV0IHdmNG5vZGUgPSByZXF1aXJlKFwiLi4vLi4vLi4vXCIpO1xubGV0IEZ1bmMgPSB3ZjRub2RlLmFjdGl2aXRpZXMuRnVuYztcbmxldCBhY3Rpdml0eU1hcmt1cCA9IHdmNG5vZGUuYWN0aXZpdGllcy5hY3Rpdml0eU1hcmt1cDtcbmxldCBBY3Rpdml0eUV4ZWN1dGlvbkVuZ2luZSA9IHdmNG5vZGUuYWN0aXZpdGllcy5BY3Rpdml0eUV4ZWN1dGlvbkVuZ2luZTtcbmxldCBhc3NlcnQgPSByZXF1aXJlKFwiYXNzZXJ0XCIpO1xubGV0IEJsdWViaXJkID0gcmVxdWlyZShcImJsdWViaXJkXCIpO1xubGV0IEJsb2NrID0gd2Y0bm9kZS5hY3Rpdml0aWVzLkJsb2NrO1xubGV0IF8gPSByZXF1aXJlKFwibG9kYXNoXCIpO1xuXG5kZXNjcmliZShcImNvbmRpdGlvbmFsc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgZGVzY3JpYmUoXCJJZlwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGl0KFwic2hvdWxkIGNhbGwgdGhlblwiLCBmdW5jdGlvbiAoZG9uZSkge1xuICAgICAgICAgICAgbGV0IGJsb2NrID0gYWN0aXZpdHlNYXJrdXAucGFyc2Uoe1xuICAgICAgICAgICAgICAgIFwiQGJsb2NrXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgdjogNSxcbiAgICAgICAgICAgICAgICAgICAgYXJnczogW1xuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQGlmXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZGl0aW9uOiBcIj0gdGhpcy52ID09IDVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJAZnVuY1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnczogWzFdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhICsgdGhpcy52O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJAZnVuY1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnczogWzJdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhICsgdGhpcy52O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsZXQgZW5naW5lID0gbmV3IEFjdGl2aXR5RXhlY3V0aW9uRW5naW5lKGJsb2NrKTtcbiAgICAgICAgICAgIGVuZ2luZS5pbnZva2UoKS50aGVuKFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0LmVxdWFsKHJlc3VsdCwgMSArIDUpO1xuICAgICAgICAgICAgICAgIH0pLm5vZGVpZnkoZG9uZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwic2hvdWxkIGNhbGwgZWxzZVwiLCBmdW5jdGlvbiAoZG9uZSkge1xuICAgICAgICAgICAgbGV0IGJsb2NrID0gYWN0aXZpdHlNYXJrdXAucGFyc2Uoe1xuICAgICAgICAgICAgICAgIFwiQGJsb2NrXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgdjogNSxcbiAgICAgICAgICAgICAgICAgICAgcjogMCxcbiAgICAgICAgICAgICAgICAgICAgYXJnczogW1xuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQGlmXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZGl0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkBmdW5jXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW46IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQGZ1bmNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IFsxXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnIgPSBhICsgdGhpcy52O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJAZnVuY1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnczogWzJdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuciA9IGEgKyB0aGlzLnY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiPSB0aGlzLnJcIlxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGxldCBlbmdpbmUgPSBuZXcgQWN0aXZpdHlFeGVjdXRpb25FbmdpbmUoYmxvY2spO1xuICAgICAgICAgICAgZW5naW5lLmludm9rZSgpLnRoZW4oXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQuZXF1YWwocmVzdWx0LCAyICsgNSk7XG4gICAgICAgICAgICAgICAgfSkubm9kZWlmeShkb25lKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoXCJzaG91bGQgcnVuIGJsb2Nrc1wiLCBmdW5jdGlvbiAoZG9uZSkge1xuICAgICAgICAgICAgbGV0IGJsb2NrID0gYWN0aXZpdHlNYXJrdXAucGFyc2Uoe1xuICAgICAgICAgICAgICAgIFwiQGJsb2NrXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgdjogNSxcbiAgICAgICAgICAgICAgICAgICAgczogMSxcbiAgICAgICAgICAgICAgICAgICAgYXJnczogW1xuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQGlmXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZGl0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkBmdW5jXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW46IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQGZ1bmNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IFsxXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnMgPSBhICsgdGhpcy52O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJAYmxvY2tcIjogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJAZnVuY1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiBbMl0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzZWxmID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQmx1ZWJpcmQuZGVsYXkoMTAwKS50aGVuKGZ1bmN0aW9uICgpIHsgc2VsZi5zID0gNDAgKyBhOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcIj0gdGhpcy5zXCJcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsZXQgZW5naW5lID0gbmV3IEFjdGl2aXR5RXhlY3V0aW9uRW5naW5lKGJsb2NrKTtcbiAgICAgICAgICAgIGVuZ2luZS5pbnZva2UoKS50aGVuKFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0LmVxdWFsKHJlc3VsdCwgNDIpO1xuICAgICAgICAgICAgICAgIH0pLm5vZGVpZnkoZG9uZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwidGhlbiBzaG91bGQgYmUgYSBibG9ja1wiLCBmdW5jdGlvbiAoZG9uZSkge1xuICAgICAgICAgICAgbGV0IGJsb2NrID0gYWN0aXZpdHlNYXJrdXAucGFyc2Uoe1xuICAgICAgICAgICAgICAgIFwiQGJsb2NrXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgdjogNSxcbiAgICAgICAgICAgICAgICAgICAgYXJnczogW1xuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQGlmXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZGl0aW9uOiBcIj0gdGhpcy52ID09IDVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbjogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEJsdWViaXJkLmRlbGF5KDEwMClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi52ID0gNztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI9IHRoaXMudiBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGxldCBlbmdpbmUgPSBuZXcgQWN0aXZpdHlFeGVjdXRpb25FbmdpbmUoYmxvY2spO1xuICAgICAgICAgICAgZW5naW5lLmludm9rZSgpLnRoZW4oXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQuZXF1YWwoNywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9KS5ub2RlaWZ5KGRvbmUpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChcImVsc2Ugc2hvdWxkIGJlIGEgYmxvY2tcIiwgZnVuY3Rpb24gKGRvbmUpIHtcbiAgICAgICAgICAgIGxldCBibG9jayA9IGFjdGl2aXR5TWFya3VwLnBhcnNlKHtcbiAgICAgICAgICAgICAgICBcIkBibG9ja1wiOiB7XG4gICAgICAgICAgICAgICAgICAgIHY6IDEsXG4gICAgICAgICAgICAgICAgICAgIGFyZ3M6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkBpZlwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbjogXCI9IHRoaXMudiA9PSA1XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW46IFsxLCAyXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNSwgZnVuY3Rpb24gKCkgeyB0aGlzLnYgPSA3OyB9LCBcIj0gdGhpcy52XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsZXQgZW5naW5lID0gbmV3IEFjdGl2aXR5RXhlY3V0aW9uRW5naW5lKGJsb2NrKTtcbiAgICAgICAgICAgIGVuZ2luZS5pbnZva2UoKS50aGVuKFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0LmVxdWFsKDcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSkubm9kZWlmeShkb25lKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZShcIlN3aXRjaFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlc2NyaWJlKFwic3dpdGNoIHcvIGNhc2VcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaXQoXCJzaG91bGQgd29yayB3L28gZGVmYXVsdFwiLCBmdW5jdGlvbiAoZG9uZSkge1xuICAgICAgICAgICAgICAgIGxldCBlbmdpbmUgPSBuZXcgQWN0aXZpdHlFeGVjdXRpb25FbmdpbmUoe1xuICAgICAgICAgICAgICAgICAgICBcIkBzd2l0Y2hcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbjogXCI9IDQyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkBjYXNlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiA0MyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCI1NVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQGNhc2VcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IDQyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcImhpXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJAY2FzZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogXCI0MlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnczogXCI9ICdib28nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZW5naW5lLmludm9rZSgpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydC5kZWVwRXF1YWwocmVzdWx0LCBcImhpXCIpO1xuICAgICAgICAgICAgICAgICAgICB9KS5ub2RlaWZ5KGRvbmUpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KFwic2hvdWxkIHdvcmsgdyBkZWZhdWx0XCIsIGZ1bmN0aW9uIChkb25lKSB7XG4gICAgICAgICAgICAgICAgbGV0IGVuZ2luZSA9IG5ldyBBY3Rpdml0eUV4ZWN1dGlvbkVuZ2luZSh7XG4gICAgICAgICAgICAgICAgICAgIFwiQHN3aXRjaFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBleHByZXNzaW9uOiBcIj0gNDNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQGNhc2VcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IDQzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiA1NTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkBjYXNlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiA0MixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJoaVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQGRlZmF1bHRcIjogXCI9ICdib28nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGVuZ2luZS5pbnZva2UoKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKHJlc3VsdCwgNTUpO1xuICAgICAgICAgICAgICAgICAgICB9KS5ub2RlaWZ5KGRvbmUpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KFwic2hvdWxkIGRvIGl0cyBkZWZhdWx0XCIsIGZ1bmN0aW9uIChkb25lKSB7XG4gICAgICAgICAgICAgICAgbGV0IGVuZ2luZSA9IG5ldyBBY3Rpdml0eUV4ZWN1dGlvbkVuZ2luZSh7XG4gICAgICAgICAgICAgICAgICAgIFwiQHN3aXRjaFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBleHByZXNzaW9uOiBcIj0gJ2tsb3cnXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkBjYXNlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiA0MyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gNTU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJAY2FzZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogNDIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiaGlcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkBkZWZhdWx0XCI6IFwiPSAnYm9vJ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBlbmdpbmUuaW52b2tlKCkudGhlbihcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbChyZXN1bHQsIFwiYm9vXCIpO1xuICAgICAgICAgICAgICAgICAgICB9KS5ub2RlaWZ5KGRvbmUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRlc2NyaWJlKFwic3dpdGNoIHcvIHdoZW5cIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaXQoXCJzaG91bGQgd29yayB3L28gZGVmYXVsdFwiLCBmdW5jdGlvbiAoZG9uZSkge1xuICAgICAgICAgICAgICAgIGxldCBlbmdpbmUgPSBuZXcgQWN0aXZpdHlFeGVjdXRpb25FbmdpbmUoe1xuICAgICAgICAgICAgICAgICAgICBcIkBzd2l0Y2hcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJnczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJAd2hlblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25kaXRpb246IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiNTVcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkB3aGVuXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBCbHVlYmlyZC5yZXNvbHZlKDQyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiaGlcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkB3aGVuXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbjogXCI0MlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnczogXCI9ICdib28nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZW5naW5lLmludm9rZSgpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydC5kZWVwRXF1YWwocmVzdWx0LCBcImhpXCIpO1xuICAgICAgICAgICAgICAgICAgICB9KS5ub2RlaWZ5KGRvbmUpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KFwic2hvdWxkIHdvcmsgdyBkZWZhdWx0XCIsIGZ1bmN0aW9uIChkb25lKSB7XG4gICAgICAgICAgICAgICAgbGV0IGVuZ2luZSA9IG5ldyBBY3Rpdml0eUV4ZWN1dGlvbkVuZ2luZSh7XG4gICAgICAgICAgICAgICAgICAgIFwiQHN3aXRjaFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkB3aGVuXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbjogNDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDU1O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQHdoZW5cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZGl0aW9uOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiaGlcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkBkZWZhdWx0XCI6IFwiPSAnYm9vJ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvL2VuZ2luZS5hZGRUcmFja2VyKG5ldyBDb25zb2xlVHJhY2tlcigpKTtcblxuICAgICAgICAgICAgICAgIGVuZ2luZS5pbnZva2UoKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKHJlc3VsdCwgNTUpO1xuICAgICAgICAgICAgICAgICAgICB9KS5ub2RlaWZ5KGRvbmUpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGl0KFwic2hvdWxkIGRvIGl0cyBkZWZhdWx0XCIsIGZ1bmN0aW9uIChkb25lKSB7XG4gICAgICAgICAgICAgICAgbGV0IGVuZ2luZSA9IG5ldyBBY3Rpdml0eUV4ZWN1dGlvbkVuZ2luZSh7XG4gICAgICAgICAgICAgICAgICAgIFwiQHN3aXRjaFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkB3aGVuXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gNTU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJAd2hlblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25kaXRpb246IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiaGlcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkBkZWZhdWx0XCI6IFwiPSAnYm9vJ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBlbmdpbmUuaW52b2tlKCkudGhlbihcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbChyZXN1bHQsIFwiYm9vXCIpO1xuICAgICAgICAgICAgICAgICAgICB9KS5ub2RlaWZ5KGRvbmUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufSk7Il19
