"use strict";
var wf4node = require("../../../");
var activityMarkup = wf4node.activities.activityMarkup;
var ActivityExecutionEngine = wf4node.activities.ActivityExecutionEngine;
var path = require("path");
var assert = require("assert");
var Expression = wf4node.activities.Expression;
describe("activityMarkup", function() {
  it("should load custom activity type from string", function(done) {
    var activity = activityMarkup.parse({"@block": {
        "@require": path.join(__dirname, "/customActivities/adder"),
        a: 10,
        b: 20,
        c: 30,
        args: [{"@adder": ["=this.a", "=this.b", "=this.c"]}]
      }});
    var engine = new ActivityExecutionEngine(activity);
    engine.invoke().then(function(result) {
      assert.equal(result, 10 + 20 + 30);
    }).nodeify(done);
  });
  it("should load custom activity type from array", function(done) {
    var activity = activityMarkup.parse({
      "@require": [path.join(__dirname, "/customActivities/adder")],
      "@block": {
        a: 1,
        b: 2,
        c: 3,
        args: [{"@adder": ["= this.a", "= this.b", "= this.c"]}]
      }
    });
    var engine = new ActivityExecutionEngine(activity);
    engine.invoke().then(function(result) {
      assert.equal(result, 1 + 2 + 3);
    }).nodeify(done);
  });
});
//# sourceMappingURL=data:application/json;base64,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LCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuLyogZ2xvYmFsIGRlc2NyaWJlLGl0ICovXG5cbmxldCB3ZjRub2RlID0gcmVxdWlyZShcIi4uLy4uLy4uL1wiKTtcbmxldCBhY3Rpdml0eU1hcmt1cCA9IHdmNG5vZGUuYWN0aXZpdGllcy5hY3Rpdml0eU1hcmt1cDtcbmxldCBBY3Rpdml0eUV4ZWN1dGlvbkVuZ2luZSA9IHdmNG5vZGUuYWN0aXZpdGllcy5BY3Rpdml0eUV4ZWN1dGlvbkVuZ2luZTtcbmxldCBwYXRoID0gcmVxdWlyZShcInBhdGhcIik7XG5sZXQgYXNzZXJ0ID0gcmVxdWlyZShcImFzc2VydFwiKTtcbmxldCBFeHByZXNzaW9uID0gd2Y0bm9kZS5hY3Rpdml0aWVzLkV4cHJlc3Npb247XG5cbmRlc2NyaWJlKFwiYWN0aXZpdHlNYXJrdXBcIiwgZnVuY3Rpb24gKCkge1xuICAgIGl0KFwic2hvdWxkIGxvYWQgY3VzdG9tIGFjdGl2aXR5IHR5cGUgZnJvbSBzdHJpbmdcIiwgZnVuY3Rpb24gKGRvbmUpIHtcbiAgICAgICAgbGV0IGFjdGl2aXR5ID0gYWN0aXZpdHlNYXJrdXAucGFyc2Uoe1xuICAgICAgICAgICAgXCJAYmxvY2tcIjoge1xuICAgICAgICAgICAgICAgIFwiQHJlcXVpcmVcIjogcGF0aC5qb2luKF9fZGlybmFtZSwgXCIvY3VzdG9tQWN0aXZpdGllcy9hZGRlclwiKSxcbiAgICAgICAgICAgICAgICBhOiAxMCxcbiAgICAgICAgICAgICAgICBiOiAyMCxcbiAgICAgICAgICAgICAgICBjOiAzMCxcbiAgICAgICAgICAgICAgICBhcmdzOiBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiQGFkZGVyXCI6IFtcIj10aGlzLmFcIiwgXCI9dGhpcy5iXCIsIFwiPXRoaXMuY1wiXVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgZW5naW5lID0gbmV3IEFjdGl2aXR5RXhlY3V0aW9uRW5naW5lKGFjdGl2aXR5KTtcblxuICAgICAgICBlbmdpbmUuaW52b2tlKClcbiAgICAgICAgICAgIC50aGVuKFxuICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGFzc2VydC5lcXVhbChyZXN1bHQsIDEwICsgMjAgKyAzMCk7XG4gICAgICAgICAgICB9KS5ub2RlaWZ5KGRvbmUpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgbG9hZCBjdXN0b20gYWN0aXZpdHkgdHlwZSBmcm9tIGFycmF5XCIsIGZ1bmN0aW9uIChkb25lKSB7XG4gICAgICAgIGxldCBhY3Rpdml0eSA9IGFjdGl2aXR5TWFya3VwLnBhcnNlKHtcbiAgICAgICAgICAgIFwiQHJlcXVpcmVcIjogWyBwYXRoLmpvaW4oX19kaXJuYW1lLCBcIi9jdXN0b21BY3Rpdml0aWVzL2FkZGVyXCIpIF0sXG4gICAgICAgICAgICBcIkBibG9ja1wiOiB7XG4gICAgICAgICAgICAgICAgYTogMSxcbiAgICAgICAgICAgICAgICBiOiAyLFxuICAgICAgICAgICAgICAgIGM6IDMsXG4gICAgICAgICAgICAgICAgYXJnczogW1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIkBhZGRlclwiOiBbXCI9IHRoaXMuYVwiLCBcIj0gdGhpcy5iXCIsIFwiPSB0aGlzLmNcIl1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IGVuZ2luZSA9IG5ldyBBY3Rpdml0eUV4ZWN1dGlvbkVuZ2luZShhY3Rpdml0eSk7XG5cbiAgICAgICAgZW5naW5lLmludm9rZSgpXG4gICAgICAgICAgICAudGhlbihcbiAgICAgICAgICAgIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBhc3NlcnQuZXF1YWwocmVzdWx0LCAxICsgMiArIDMpO1xuICAgICAgICAgICAgfSkubm9kZWlmeShkb25lKTtcbiAgICB9KTtcbn0pOyJdfQ==
