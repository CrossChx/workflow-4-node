{"version":3,"sources":["activities/bookmarking.js"],"names":[],"mappings":"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","file":"activities/bookmarking.js","sourcesContent":["\"use strict\";\n\n/* global describe,it */\n\nlet wf4node = require(\"../../../\");\nlet Expression = wf4node.activities.Expression;\nlet Func = wf4node.activities.Func;\nlet Block = wf4node.activities.Block;\nlet activityMarkup = wf4node.activities.activityMarkup;\nlet ActivityExecutionEngine = wf4node.activities.ActivityExecutionEngine;\nlet _ = require(\"lodash\");\nlet ConsoleTracker = wf4node.activities.ConsoleTracker;\nlet WorkflowHost = wf4node.hosting.WorkflowHost;\nlet InstanceIdParser = wf4node.hosting.InstanceIdParser;\nlet assert = require(\"assert\");\n\ndescribe(\"bookmarking\", function () {\n    it(\"should handle parallel activities\", function (done) {\n        let activity = activityMarkup.parse(\n            {\n                \"@parallel\": {\n                    var1: \"\",\n                    displayName: \"Root\",\n                    args: [\n                        {\n                            \"@block\": {\n                                displayName: \"Wait Block 1\",\n                                args: [\n                                    {\n                                        \"@waitForBookmark\": {\n                                            displayName: \"Wait 1\",\n                                            bookmarkName: \"bm1\"\n                                        }\n                                    },\n                                    {\n                                        \"@func\": {\n                                            displayName: \"Func 1\",\n                                            code: function () {\n                                                return this.var1 += \"a\";\n                                            }\n                                        }\n                                    }\n                                ]\n                            }\n                        },\n                        {\n                            \"@block\": {\n                                displayName: \"Wait Block 2\",\n                                args: [\n                                    {\n                                        \"@waitForBookmark\": {\n                                            displayName: \"Wait 2\",\n                                            bookmarkName: \"bm2\"\n                                        }\n                                    },\n                                    {\n                                        \"@func\": {\n                                            displayName: \"Func 2\",\n                                            code: function () {\n                                                return this.var1 += \"b\";\n                                            }\n                                        }\n                                    }\n                                ]\n                            }\n                        },\n                        {\n                            \"@block\": {\n                                displayName: \"Resume Block\",\n                                args: [\n                                    {\n                                        \"@resumeBookmark\": {\n                                            displayName: \"Resume 1\",\n                                            bookmarkName: \"bm1\"\n                                        }\n                                    },\n                                    {\n                                        \"@resumeBookmark\": {\n                                            displayName: \"Resume 2\",\n                                            bookmarkName: \"bm2\"\n                                        }\n                                    },\n                                    \"bubu\"\n                                ]\n                            }\n                        }\n                    ]\n                }\n            });\n\n        let engine = new ActivityExecutionEngine(activity);\n        //engine.addTracker(new ConsoleTracker());\n\n        engine.invoke().then(\n            function (result) {\n                try {\n                    assert.ok(_.isArray(result));\n                    assert.equal(result.length, 3);\n                    assert.equal(result[0], \"a\");\n                    assert.equal(result[1], \"ab\");\n                    assert.equal(result[2], \"bubu\");\n                }\n                catch (e) {\n                    assert.ifError(e);\n                }\n            }).nodeify(done);\n    });\n\n    it(\"should handle of picking activities\", function (done) {\n        let activity = activityMarkup.parse(\n            {\n                \"@block\": {\n                    var1: 0,\n                    args: [\n                        {\n                            \"@parallel\": [\n                                {\n                                    \"@pick\": [\n                                        {\n                                            \"@block\": [\n                                                {\n                                                    \"@waitForBookmark\": {\n                                                        bookmarkName: \"foo\"\n                                                    }\n                                                },\n                                                {\n                                                    \"@func\": {\n                                                        displayName: \"Do Not Do This Func\",\n                                                        code: function () {\n                                                            this.var1 = -1;\n                                                        }\n                                                    }\n                                                }\n                                            ]\n                                        },\n                                        {\n                                            \"@block\": [\n                                                {\n                                                    \"@waitForBookmark\": {\n                                                        bookmarkName: \"bm\"\n                                                    }\n                                                },\n                                                {\n                                                    \"@func\": {\n                                                        displayName: \"Do This Func\",\n                                                        code: function () {\n                                                            this.var1 = 1;\n                                                        }\n                                                    }\n                                                }\n                                            ]\n                                        }\n                                    ]\n                                },\n                                {\n                                    \"@resumeBookmark\": {\n                                        bookmarkName: \"bm\"\n                                    }\n                                }\n                            ]\n                        },\n                        {\n                            \"@func\": {\n                                displayName: \"Final Func\",\n                                code: function () {\n                                    return this.var1;\n                                }\n                            }\n                        }\n                    ]\n                }\n            });\n\n        let engine = new ActivityExecutionEngine(activity);\n        //engine.addTracker(new ConsoleTracker());\n\n        engine.invoke().then(\n            function (result) {\n                try {\n                    assert.equal(result, 1);\n                }\n                catch (e) {\n                    assert.ifError(e);\n                }\n            }).nodeify(done);\n    });\n});"],"sourceRoot":"/source/"}