{"version":3,"names":[],"mappings":"","sources":["activities/activityExecutionState.js"],"sourcesContent":["\"use strict\";\n\nlet EventEmitter = require('events').EventEmitter;\nlet util = require(\"util\");\nlet enums = require(\"../common/enums\");\nlet is = require(\"../common/is\");\nlet _ = require(\"lodash\");\n\nfunction ActivityExecutionState(activityInstanceId) {\n    this.instanceId = activityInstanceId;\n    this.execState = null;\n    this.parentInstanceId = null;\n    this.childInstanceIds = new Set();\n}\n\nutil.inherits(ActivityExecutionState, EventEmitter);\n\nObject.defineProperties(ActivityExecutionState.prototype, {\n    isRunning: {\n        get: function () {\n            return this.execState === enums.activityStates.run;\n        }\n    }\n});\n\nActivityExecutionState.prototype.reportState = function (reason, result, scope) {\n    if (this.execState !== reason) {\n        this.execState = reason;\n        this._emitState({\n            reason: reason,\n            result: result,\n            scope: scope\n        });\n    }\n};\n\nActivityExecutionState.prototype.emitState = function (result, scope) {\n    this._emitState({\n        reason: this.execState,\n        result: result,\n        scope: scope\n    });\n};\n\nActivityExecutionState.prototype._emitState = function (args) {\n    this.emit(args.reason, args);\n    if (args.reason !== enums.activityStates.run) {\n        this.emit(enums.activityStates.end, args);\n    }\n};\n\n/* SERIALIZATION */\nActivityExecutionState.prototype.asJSON = function () {\n    return {\n        execState: this.execState\n    };\n};\n\nActivityExecutionState.prototype.fromJSON = function (json) {\n    if (!_.isObject(json)) {\n        throw new TypeError(\"Object argument expected.\");\n    }\n    if (json.execState !== null) {\n        if (!_.isString(json.execState)) {\n            throw new TypeError(\"Argument object's execState property value is not a string.\");\n        }\n        if (_.isUndefined(enums.activityStates[json.execState])) {\n            throw new TypeError(\"Argument object's execState property value is not a valid Activity state value.\");\n        }\n    }\n\n    this.execState = json.execState;\n};\n/* SERIALIZATION */\n\nmodule.exports = ActivityExecutionState;\n"],"file":"activities/activityExecutionState.js","sourceRoot":"/source/"}