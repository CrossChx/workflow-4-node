{"version":3,"names":[],"mappings":"","sources":["activities/activityExecutionState.js"],"sourcesContent":["\"use strict\";\r\n\r\nlet EventEmitter = require('events').EventEmitter;\r\nlet util = require(\"util\");\r\nlet enums = require(\"../common/enums\");\r\nlet is = require(\"../common/is\");\r\nlet _ = require(\"lodash\");\r\n\r\nfunction ActivityExecutionState(activityInstanceId) {\r\n    this.instanceId = activityInstanceId;\r\n    this.execState = null;\r\n    this.parentInstanceId = null;\r\n    this.childInstanceIds = new Set();\r\n}\r\n\r\nutil.inherits(ActivityExecutionState, EventEmitter);\r\n\r\nObject.defineProperties(ActivityExecutionState.prototype, {\r\n    isRunning: {\r\n        get: function () {\r\n            return this.execState === enums.activityStates.run;\r\n        }\r\n    }\r\n});\r\n\r\nActivityExecutionState.prototype.reportState = function (reason, result, scope) {\r\n    if (this.execState !== reason) {\r\n        this.execState = reason;\r\n        this._emitState({\r\n            reason: reason,\r\n            result: result,\r\n            scope: scope\r\n        });\r\n    }\r\n};\r\n\r\nActivityExecutionState.prototype.emitState = function (result, scope) {\r\n    this._emitState({\r\n        reason: this.execState,\r\n        result: result,\r\n        scope: scope\r\n    });\r\n};\r\n\r\nActivityExecutionState.prototype._emitState = function (args) {\r\n    this.emit(args.reason, args);\r\n    if (args.reason !== enums.activityStates.run) {\r\n        this.emit(enums.activityStates.end, args);\r\n    }\r\n};\r\n\r\n/* SERIALIZATION */\r\nActivityExecutionState.prototype.asJSON = function () {\r\n    return {\r\n        execState: this.execState\r\n    };\r\n};\r\n\r\nActivityExecutionState.prototype.fromJSON = function (json) {\r\n    if (!_.isObject(json)) {\r\n        throw new TypeError(\"Object argument expected.\");\r\n    }\r\n    if (json.execState !== null) {\r\n        if (!_.isString(json.execState)) {\r\n            throw new TypeError(\"Argument object's execState property value is not a string.\");\r\n        }\r\n        if (_.isUndefined(enums.activityStates[json.execState])) {\r\n            throw new TypeError(\"Argument object's execState property value is not a valid Activity state value.\");\r\n        }\r\n    }\r\n\r\n    this.execState = json.execState;\r\n};\r\n/* SERIALIZATION */\r\n\r\nmodule.exports = ActivityExecutionState;\r\n"],"file":"activities/activityExecutionState.js","sourceRoot":"/source/"}