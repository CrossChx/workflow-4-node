"use strict";
var Activity = require('./activity');
var util = require('util');
var _ = require('lodash');
var fast = require('fast.js');
function And() {
  Activity.call(this);
  this.isTrue = true;
  this.isFalse = false;
}
util.inherits(And, Activity);
And.prototype.run = function(callContext, args) {
  callContext.schedule(args, '_argsGot');
};
And.prototype._argsGot = function(callContext, reason, result) {
  if (reason !== Activity.states.complete) {
    callContext.end(reason, result);
    return ;
  }
  var isTrue = false;
  if (result.length) {
    isTrue = true;
    fast.forEach(result, function(v) {
      isTrue = (v ? true : false) && isTrue;
    });
  }
  if (isTrue) {
    callContext.schedule(this.get('isTrue'), '_done');
  } else {
    callContext.schedule(this.get('isFalse'), '_done');
  }
};
And.prototype._done = function(callContext, reason, result) {
  callContext.end(reason, result);
};
module.exports = And;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuZC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUFBLEFBQUksRUFBQSxDQUFBLFFBQU8sRUFBSSxDQUFBLE9BQU0sQUFBQyxDQUFDLFlBQVcsQ0FBQyxDQUFDO0FBQ3BDLEFBQUksRUFBQSxDQUFBLElBQUcsRUFBSSxDQUFBLE9BQU0sQUFBQyxDQUFDLE1BQUssQ0FBQyxDQUFDO0FBQzFCLEFBQUksRUFBQSxDQUFBLENBQUEsRUFBSSxDQUFBLE9BQU0sQUFBQyxDQUFDLFFBQU8sQ0FBQyxDQUFDO0FBQ3pCLEFBQUksRUFBQSxDQUFBLElBQUcsRUFBSSxDQUFBLE9BQU0sQUFBQyxDQUFDLFNBQVEsQ0FBQyxDQUFDO0FBRTdCLE9BQVMsSUFBRSxDQUFFLEFBQUQsQ0FBRztBQUNYLFNBQU8sS0FBSyxBQUFDLENBQUMsSUFBRyxDQUFDLENBQUM7QUFFbkIsS0FBRyxPQUFPLEVBQUksS0FBRyxDQUFDO0FBQ2xCLEtBQUcsUUFBUSxFQUFJLE1BQUksQ0FBQztBQUN4QjtBQUFBLEFBRUEsR0FBRyxTQUFTLEFBQUMsQ0FBQyxHQUFFLENBQUcsU0FBTyxDQUFDLENBQUM7QUFFNUIsRUFBRSxVQUFVLElBQUksRUFBSSxVQUFVLFdBQVUsQ0FBRyxDQUFBLElBQUcsQ0FBRztBQUM3QyxZQUFVLFNBQVMsQUFBQyxDQUFDLElBQUcsQ0FBRyxXQUFTLENBQUMsQ0FBQztBQUMxQyxDQUFBO0FBRUEsRUFBRSxVQUFVLFNBQVMsRUFBSSxVQUFTLFdBQVUsQ0FBRyxDQUFBLE1BQUssQ0FBRyxDQUFBLE1BQUssQ0FBRztBQUMzRCxLQUFJLE1BQUssSUFBTSxDQUFBLFFBQU8sT0FBTyxTQUFTLENBQUc7QUFDckMsY0FBVSxJQUFJLEFBQUMsQ0FBQyxNQUFLLENBQUcsT0FBSyxDQUFDLENBQUM7QUFDL0IsV0FBTTtFQUNWO0FBQUEsQUFFSSxJQUFBLENBQUEsTUFBSyxFQUFJLE1BQUksQ0FBQztBQUNsQixLQUFJLE1BQUssT0FBTyxDQUFHO0FBQ2YsU0FBSyxFQUFJLEtBQUcsQ0FBQztBQUNiLE9BQUcsUUFBUSxBQUFDLENBQUMsTUFBSyxDQUFHLFVBQVUsQ0FBQSxDQUFHO0FBQzlCLFdBQUssRUFBSSxDQUFBLENBQUMsQ0FBQSxFQUFJLEtBQUcsRUFBSSxNQUFJLENBQUMsR0FBSyxPQUFLLENBQUM7SUFDekMsQ0FBQyxDQUFDO0VBQ047QUFBQSxBQUVBLEtBQUksTUFBSyxDQUFHO0FBQ1IsY0FBVSxTQUFTLEFBQUMsQ0FBQyxJQUFHLElBQUksQUFBQyxDQUFDLFFBQU8sQ0FBQyxDQUFHLFFBQU0sQ0FBQyxDQUFDO0VBQ3JELEtBQ0s7QUFDRCxjQUFVLFNBQVMsQUFBQyxDQUFDLElBQUcsSUFBSSxBQUFDLENBQUMsU0FBUSxDQUFDLENBQUcsUUFBTSxDQUFDLENBQUM7RUFDdEQ7QUFBQSxBQUNKLENBQUE7QUFFQSxFQUFFLFVBQVUsTUFBTSxFQUFJLFVBQVMsV0FBVSxDQUFHLENBQUEsTUFBSyxDQUFHLENBQUEsTUFBSyxDQUFHO0FBQ3hELFlBQVUsSUFBSSxBQUFDLENBQUMsTUFBSyxDQUFHLE9BQUssQ0FBQyxDQUFDO0FBQ25DLENBQUE7QUFFQSxLQUFLLFFBQVEsRUFBSSxJQUFFLENBQUM7QUFBQSIsImZpbGUiOiJhY3Rpdml0aWVzL2FuZC5qcyIsInNvdXJjZVJvb3QiOiJsaWIvZXM2Iiwic291cmNlc0NvbnRlbnQiOlsidmFyIEFjdGl2aXR5ID0gcmVxdWlyZSgnLi9hY3Rpdml0eScpO1xudmFyIHV0aWwgPSByZXF1aXJlKCd1dGlsJyk7XG52YXIgXyA9IHJlcXVpcmUoJ2xvZGFzaCcpO1xudmFyIGZhc3QgPSByZXF1aXJlKCdmYXN0LmpzJyk7XG5cbmZ1bmN0aW9uIEFuZCgpIHtcbiAgICBBY3Rpdml0eS5jYWxsKHRoaXMpO1xuXG4gICAgdGhpcy5pc1RydWUgPSB0cnVlO1xuICAgIHRoaXMuaXNGYWxzZSA9IGZhbHNlO1xufVxuXG51dGlsLmluaGVyaXRzKEFuZCwgQWN0aXZpdHkpO1xuXG5BbmQucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uIChjYWxsQ29udGV4dCwgYXJncykge1xuICAgIGNhbGxDb250ZXh0LnNjaGVkdWxlKGFyZ3MsICdfYXJnc0dvdCcpO1xufVxuXG5BbmQucHJvdG90eXBlLl9hcmdzR290ID0gZnVuY3Rpb24oY2FsbENvbnRleHQsIHJlYXNvbiwgcmVzdWx0KSB7XG4gICAgaWYgKHJlYXNvbiAhPT0gQWN0aXZpdHkuc3RhdGVzLmNvbXBsZXRlKSB7XG4gICAgICAgIGNhbGxDb250ZXh0LmVuZChyZWFzb24sIHJlc3VsdCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgaXNUcnVlID0gZmFsc2U7XG4gICAgaWYgKHJlc3VsdC5sZW5ndGgpIHtcbiAgICAgICAgaXNUcnVlID0gdHJ1ZTtcbiAgICAgICAgZmFzdC5mb3JFYWNoKHJlc3VsdCwgZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgIGlzVHJ1ZSA9ICh2ID8gdHJ1ZSA6IGZhbHNlKSAmJiBpc1RydWU7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChpc1RydWUpIHtcbiAgICAgICAgY2FsbENvbnRleHQuc2NoZWR1bGUodGhpcy5nZXQoJ2lzVHJ1ZScpLCAnX2RvbmUnKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNhbGxDb250ZXh0LnNjaGVkdWxlKHRoaXMuZ2V0KCdpc0ZhbHNlJyksICdfZG9uZScpO1xuICAgIH1cbn1cblxuQW5kLnByb3RvdHlwZS5fZG9uZSA9IGZ1bmN0aW9uKGNhbGxDb250ZXh0LCByZWFzb24sIHJlc3VsdCkge1xuICAgIGNhbGxDb250ZXh0LmVuZChyZWFzb24sIHJlc3VsdCk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gQW5kOyJdfQ==
