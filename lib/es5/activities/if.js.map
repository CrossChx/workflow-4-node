{"version":3,"names":[],"mappings":"","sources":["activities/if.js"],"sourcesContent":["\"use strict\";\r\n\r\nlet Activity = require(\"./activity\");\r\nlet util = require(\"util\");\r\nlet Block = require(\"./block\");\r\nlet _ = require(\"lodash\");\r\n\r\nfunction If() {\r\n    Activity.call(this);\r\n\r\n    this.arrayProperties.add(\"then\");\r\n    this.arrayProperties.add(\"else\");\r\n\r\n    this.condition = null;\r\n    this.then = null;\r\n    this.else = null;\r\n}\r\n\r\nutil.inherits(If, Activity);\r\n\r\nIf.prototype.initializeStructure = function() {\r\n    if (this.then) {\r\n        let prev = this.then;\r\n        this.then = new Block();\r\n        this.then.args = prev;\r\n    }\r\n    if (this.else) {\r\n        let prev = this.else;\r\n        this.else = new Block();\r\n        this.else.args = prev;\r\n    }\r\n};\r\n\r\nIf.prototype.run = function (callContext, args) {\r\n    let condition = this.condition;\r\n    if (condition) {\r\n        callContext.schedule(condition, \"_conditionGot\");\r\n    }\r\n    else {\r\n        callContext.complete();\r\n    }\r\n};\r\n\r\nIf.prototype._conditionGot = function (callContext, reason, result) {\r\n    if (reason === Activity.states.complete) {\r\n        if (result) {\r\n            let then = this.then;\r\n            if (then) {\r\n                callContext.schedule(then, \"_bodyFinished\");\r\n                return;\r\n            }\r\n        }\r\n        else {\r\n            let _else = this.else;\r\n            if (_else) {\r\n                callContext.schedule(_else, \"_bodyFinished\");\r\n                return;\r\n            }\r\n        }\r\n        callContext.complete();\r\n    }\r\n    else {\r\n        callContext.end(reason, result);\r\n    }\r\n};\r\n\r\nIf.prototype._bodyFinished = function (callContext, reason, result) {\r\n    callContext.end(reason, result);\r\n};\r\n\r\nmodule.exports = If;\r\n"],"file":"activities/if.js","sourceRoot":"/source/"}