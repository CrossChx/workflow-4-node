"use strict";
"use strict";
var Activity = require("./activity");
var util = require("util");
var _ = require("lodash");
var guids = require("../common/guids");
var WithBody = require("./withBody");
function When() {
  WithBody.call(this);
  this.condition = null;
}
util.inherits(When, WithBody);
When.prototype.run = function(callContext, args) {
  callContext.schedule(this.get("condition"), "_conditionGot");
};
When.prototype._conditionGot = function(callContext, reason, result) {
  if (reason === Activity.states.complete) {
    if (result) {
      WithBody.prototype.run.call(this, callContext);
    } else {
      callContext.complete(guids.markers.nope);
    }
  } else {
    callContext.end(reason, result);
  }
};
module.exports = When;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndoZW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQSxXQUFXLENBQUM7QUFFWixBQUFJLEVBQUEsQ0FBQSxRQUFPLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxZQUFXLENBQUMsQ0FBQztBQUNwQyxBQUFJLEVBQUEsQ0FBQSxJQUFHLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxNQUFLLENBQUMsQ0FBQztBQUMxQixBQUFJLEVBQUEsQ0FBQSxDQUFBLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxRQUFPLENBQUMsQ0FBQztBQUN6QixBQUFJLEVBQUEsQ0FBQSxLQUFJLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxpQkFBZ0IsQ0FBQyxDQUFDO0FBQ3RDLEFBQUksRUFBQSxDQUFBLFFBQU8sRUFBSSxDQUFBLE9BQU0sQUFBQyxDQUFDLFlBQVcsQ0FBQyxDQUFDO0FBRXBDLE9BQVMsS0FBRyxDQUFFLEFBQUQsQ0FBRztBQUNaLFNBQU8sS0FBSyxBQUFDLENBQUMsSUFBRyxDQUFDLENBQUM7QUFFbkIsS0FBRyxVQUFVLEVBQUksS0FBRyxDQUFDO0FBQ3pCO0FBQUEsQUFFQSxHQUFHLFNBQVMsQUFBQyxDQUFDLElBQUcsQ0FBRyxTQUFPLENBQUMsQ0FBQztBQUU3QixHQUFHLFVBQVUsSUFBSSxFQUFJLFVBQVUsV0FBVSxDQUFHLENBQUEsSUFBRyxDQUFHO0FBQzlDLFlBQVUsU0FBUyxBQUFDLENBQUMsSUFBRyxJQUFJLEFBQUMsQ0FBQyxXQUFVLENBQUMsQ0FBRyxnQkFBYyxDQUFDLENBQUM7QUFDaEUsQ0FBQztBQUVELEdBQUcsVUFBVSxjQUFjLEVBQUksVUFBVSxXQUFVLENBQUcsQ0FBQSxNQUFLLENBQUcsQ0FBQSxNQUFLLENBQUc7QUFDbEUsS0FBSSxNQUFLLElBQU0sQ0FBQSxRQUFPLE9BQU8sU0FBUyxDQUFHO0FBQ3JDLE9BQUksTUFBSyxDQUFHO0FBQ1IsYUFBTyxVQUFVLElBQUksS0FBSyxBQUFDLENBQUMsSUFBRyxDQUFHLFlBQVUsQ0FBQyxDQUFDO0lBQ2xELEtBQ0s7QUFDRCxnQkFBVSxTQUFTLEFBQUMsQ0FBQyxLQUFJLFFBQVEsS0FBSyxDQUFDLENBQUM7SUFDNUM7QUFBQSxFQUNKLEtBQ0s7QUFDRCxjQUFVLElBQUksQUFBQyxDQUFDLE1BQUssQ0FBRyxPQUFLLENBQUMsQ0FBQztFQUNuQztBQUFBLEFBQ0osQ0FBQztBQUVELEtBQUssUUFBUSxFQUFJLEtBQUcsQ0FBQztBQUFBIiwiZmlsZSI6ImFjdGl2aXRpZXMvd2hlbi5qcyIsInNvdXJjZVJvb3QiOiJsaWIvZXM2Iiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmxldCBBY3Rpdml0eSA9IHJlcXVpcmUoXCIuL2FjdGl2aXR5XCIpO1xubGV0IHV0aWwgPSByZXF1aXJlKFwidXRpbFwiKTtcbmxldCBfID0gcmVxdWlyZShcImxvZGFzaFwiKTtcbmxldCBndWlkcyA9IHJlcXVpcmUoXCIuLi9jb21tb24vZ3VpZHNcIik7XG5sZXQgV2l0aEJvZHkgPSByZXF1aXJlKFwiLi93aXRoQm9keVwiKTtcblxuZnVuY3Rpb24gV2hlbigpIHtcbiAgICBXaXRoQm9keS5jYWxsKHRoaXMpO1xuXG4gICAgdGhpcy5jb25kaXRpb24gPSBudWxsO1xufVxuXG51dGlsLmluaGVyaXRzKFdoZW4sIFdpdGhCb2R5KTtcblxuV2hlbi5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKGNhbGxDb250ZXh0LCBhcmdzKSB7XG4gICAgY2FsbENvbnRleHQuc2NoZWR1bGUodGhpcy5nZXQoXCJjb25kaXRpb25cIiksIFwiX2NvbmRpdGlvbkdvdFwiKTtcbn07XG5cbldoZW4ucHJvdG90eXBlLl9jb25kaXRpb25Hb3QgPSBmdW5jdGlvbiAoY2FsbENvbnRleHQsIHJlYXNvbiwgcmVzdWx0KSB7XG4gICAgaWYgKHJlYXNvbiA9PT0gQWN0aXZpdHkuc3RhdGVzLmNvbXBsZXRlKSB7XG4gICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgIFdpdGhCb2R5LnByb3RvdHlwZS5ydW4uY2FsbCh0aGlzLCBjYWxsQ29udGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjYWxsQ29udGV4dC5jb21wbGV0ZShndWlkcy5tYXJrZXJzLm5vcGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjYWxsQ29udGV4dC5lbmQocmVhc29uLCByZXN1bHQpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gV2hlbjsiXX0=
