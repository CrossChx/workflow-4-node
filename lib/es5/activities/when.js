"use strict";
var Activity = require("./activity");
var util = require("util");
var _ = require("lodash");
var guids = require("../common/guids");
var WithBody = require("./withBody");
function When() {
  WithBody.call(this);
  this.condition = null;
}
util.inherits(When, WithBody);
When.prototype.run = function(callContext, args) {
  callContext.schedule(this.condition, "_conditionGot");
};
When.prototype._conditionGot = function(callContext, reason, result) {
  if (reason === Activity.states.complete) {
    if (result) {
      WithBody.prototype.run.call(this, callContext);
    } else {
      callContext.complete(guids.markers.nope);
    }
  } else {
    callContext.end(reason, result);
  }
};
module.exports = When;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndoZW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFFQSxBQUFJLEVBQUEsQ0FBQSxRQUFPLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxZQUFXLENBQUMsQ0FBQztBQUNwQyxBQUFJLEVBQUEsQ0FBQSxJQUFHLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxNQUFLLENBQUMsQ0FBQztBQUMxQixBQUFJLEVBQUEsQ0FBQSxDQUFBLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxRQUFPLENBQUMsQ0FBQztBQUN6QixBQUFJLEVBQUEsQ0FBQSxLQUFJLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxpQkFBZ0IsQ0FBQyxDQUFDO0FBQ3RDLEFBQUksRUFBQSxDQUFBLFFBQU8sRUFBSSxDQUFBLE9BQU0sQUFBQyxDQUFDLFlBQVcsQ0FBQyxDQUFDO0FBRXBDLE9BQVMsS0FBRyxDQUFFLEFBQUQsQ0FBRztBQUNaLFNBQU8sS0FBSyxBQUFDLENBQUMsSUFBRyxDQUFDLENBQUM7QUFFbkIsS0FBRyxVQUFVLEVBQUksS0FBRyxDQUFDO0FBQ3pCO0FBQUEsQUFFQSxHQUFHLFNBQVMsQUFBQyxDQUFDLElBQUcsQ0FBRyxTQUFPLENBQUMsQ0FBQztBQUU3QixHQUFHLFVBQVUsSUFBSSxFQUFJLFVBQVUsV0FBVSxDQUFHLENBQUEsSUFBRyxDQUFHO0FBQzlDLFlBQVUsU0FBUyxBQUFDLENBQUMsSUFBRyxVQUFVLENBQUcsZ0JBQWMsQ0FBQyxDQUFDO0FBQ3pELENBQUM7QUFFRCxHQUFHLFVBQVUsY0FBYyxFQUFJLFVBQVUsV0FBVSxDQUFHLENBQUEsTUFBSyxDQUFHLENBQUEsTUFBSyxDQUFHO0FBQ2xFLEtBQUksTUFBSyxJQUFNLENBQUEsUUFBTyxPQUFPLFNBQVMsQ0FBRztBQUNyQyxPQUFJLE1BQUssQ0FBRztBQUNSLGFBQU8sVUFBVSxJQUFJLEtBQUssQUFBQyxDQUFDLElBQUcsQ0FBRyxZQUFVLENBQUMsQ0FBQztJQUNsRCxLQUNLO0FBQ0QsZ0JBQVUsU0FBUyxBQUFDLENBQUMsS0FBSSxRQUFRLEtBQUssQ0FBQyxDQUFDO0lBQzVDO0FBQUEsRUFDSixLQUNLO0FBQ0QsY0FBVSxJQUFJLEFBQUMsQ0FBQyxNQUFLLENBQUcsT0FBSyxDQUFDLENBQUM7RUFDbkM7QUFBQSxBQUNKLENBQUM7QUFFRCxLQUFLLFFBQVEsRUFBSSxLQUFHLENBQUM7QUFBQSIsImZpbGUiOiJhY3Rpdml0aWVzL3doZW4uanMiLCJzb3VyY2VSb290IjoibGliL2VzNiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5sZXQgQWN0aXZpdHkgPSByZXF1aXJlKFwiLi9hY3Rpdml0eVwiKTtcbmxldCB1dGlsID0gcmVxdWlyZShcInV0aWxcIik7XG5sZXQgXyA9IHJlcXVpcmUoXCJsb2Rhc2hcIik7XG5sZXQgZ3VpZHMgPSByZXF1aXJlKFwiLi4vY29tbW9uL2d1aWRzXCIpO1xubGV0IFdpdGhCb2R5ID0gcmVxdWlyZShcIi4vd2l0aEJvZHlcIik7XG5cbmZ1bmN0aW9uIFdoZW4oKSB7XG4gICAgV2l0aEJvZHkuY2FsbCh0aGlzKTtcblxuICAgIHRoaXMuY29uZGl0aW9uID0gbnVsbDtcbn1cblxudXRpbC5pbmhlcml0cyhXaGVuLCBXaXRoQm9keSk7XG5cbldoZW4ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uIChjYWxsQ29udGV4dCwgYXJncykge1xuICAgIGNhbGxDb250ZXh0LnNjaGVkdWxlKHRoaXMuY29uZGl0aW9uLCBcIl9jb25kaXRpb25Hb3RcIik7XG59O1xuXG5XaGVuLnByb3RvdHlwZS5fY29uZGl0aW9uR290ID0gZnVuY3Rpb24gKGNhbGxDb250ZXh0LCByZWFzb24sIHJlc3VsdCkge1xuICAgIGlmIChyZWFzb24gPT09IEFjdGl2aXR5LnN0YXRlcy5jb21wbGV0ZSkge1xuICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICBXaXRoQm9keS5wcm90b3R5cGUucnVuLmNhbGwodGhpcywgY2FsbENvbnRleHQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY2FsbENvbnRleHQuY29tcGxldGUoZ3VpZHMubWFya2Vycy5ub3BlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY2FsbENvbnRleHQuZW5kKHJlYXNvbiwgcmVzdWx0KTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFdoZW47Il19
