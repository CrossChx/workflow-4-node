"use strict";
var Activity = require("./activity");
var util = require("util");
var Declarator = require("./declarator");
function Block() {
  Declarator.call(this);
}
util.inherits(Block, Declarator);
Block.prototype.varsDeclared = function(callContext, args) {
  var todo = [];
  this.set("_todo", todo);
  if (args.length) {
    for (var i = args.length - 1; i >= 1; i--) {
      todo.push(args[i]);
    }
    callContext.schedule(args[0], "_argGot");
  } else {
    callContext.end(Activity.states.complete, null);
  }
};
Block.prototype._argGot = function(callContext, reason, result) {
  var todo = this.get("_todo");
  if (reason === Activity.states.complete) {
    if (todo.length === 0) {
      callContext.complete(result);
    } else {
      callContext.schedule(todo.pop(), "_argGot");
    }
  } else {
    callContext.end(reason, result);
  }
};
module.exports = Block;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJsb2NrLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUEsQUFBSSxFQUFBLENBQUEsUUFBTyxFQUFJLENBQUEsT0FBTSxBQUFDLENBQUMsWUFBVyxDQUFDLENBQUM7QUFDcEMsQUFBSSxFQUFBLENBQUEsSUFBRyxFQUFJLENBQUEsT0FBTSxBQUFDLENBQUMsTUFBSyxDQUFDLENBQUM7QUFDMUIsQUFBSSxFQUFBLENBQUEsVUFBUyxFQUFJLENBQUEsT0FBTSxBQUFDLENBQUMsY0FBYSxDQUFDLENBQUM7QUFFeEMsT0FBUyxNQUFJLENBQUUsQUFBRCxDQUFHO0FBQ2IsV0FBUyxLQUFLLEFBQUMsQ0FBQyxJQUFHLENBQUMsQ0FBQztBQUN6QjtBQUFBLEFBRUEsR0FBRyxTQUFTLEFBQUMsQ0FBQyxLQUFJLENBQUcsV0FBUyxDQUFDLENBQUM7QUFFaEMsSUFBSSxVQUFVLGFBQWEsRUFBSSxVQUFVLFdBQVUsQ0FBRyxDQUFBLElBQUcsQ0FBRztBQUN4RCxBQUFJLElBQUEsQ0FBQSxJQUFHLEVBQUksR0FBQyxDQUFDO0FBQ2IsS0FBRyxJQUFJLEFBQUMsQ0FBQyxPQUFNLENBQUcsS0FBRyxDQUFDLENBQUM7QUFDdkIsS0FBSSxJQUFHLE9BQU8sQ0FBRztBQUNiLFFBQVMsR0FBQSxDQUFBLENBQUEsRUFBSSxDQUFBLElBQUcsT0FBTyxFQUFJLEVBQUEsQ0FBRyxDQUFBLENBQUEsR0FBSyxFQUFBLENBQUcsQ0FBQSxDQUFBLEVBQUUsQ0FBRztBQUN2QyxTQUFHLEtBQUssQUFBQyxDQUFDLElBQUcsQ0FBRSxDQUFBLENBQUMsQ0FBQyxDQUFDO0lBQ3RCO0FBQUEsQUFDQSxjQUFVLFNBQVMsQUFBQyxDQUFDLElBQUcsQ0FBRSxDQUFBLENBQUMsQ0FBRyxVQUFRLENBQUMsQ0FBQztFQUM1QyxLQUNLO0FBQ0QsY0FBVSxJQUFJLEFBQUMsQ0FBQyxRQUFPLE9BQU8sU0FBUyxDQUFHLEtBQUcsQ0FBQyxDQUFDO0VBQ25EO0FBQUEsQUFDSixDQUFBO0FBRUEsSUFBSSxVQUFVLFFBQVEsRUFBSSxVQUFVLFdBQVUsQ0FBRyxDQUFBLE1BQUssQ0FBRyxDQUFBLE1BQUssQ0FBRztBQUM3RCxBQUFJLElBQUEsQ0FBQSxJQUFHLEVBQUksQ0FBQSxJQUFHLElBQUksQUFBQyxDQUFDLE9BQU0sQ0FBQyxDQUFDO0FBQzVCLEtBQUksTUFBSyxJQUFNLENBQUEsUUFBTyxPQUFPLFNBQVMsQ0FBRztBQUNyQyxPQUFJLElBQUcsT0FBTyxJQUFNLEVBQUEsQ0FBRztBQUNuQixnQkFBVSxTQUFTLEFBQUMsQ0FBQyxNQUFLLENBQUMsQ0FBQztJQUNoQyxLQUNLO0FBQ0QsZ0JBQVUsU0FBUyxBQUFDLENBQUMsSUFBRyxJQUFJLEFBQUMsRUFBQyxDQUFHLFVBQVEsQ0FBQyxDQUFDO0lBQy9DO0FBQUEsRUFDSixLQUNLO0FBQ0QsY0FBVSxJQUFJLEFBQUMsQ0FBQyxNQUFLLENBQUcsT0FBSyxDQUFDLENBQUM7RUFDbkM7QUFBQSxBQUNKLENBQUE7QUFFQSxLQUFLLFFBQVEsRUFBSSxNQUFJLENBQUM7QUFBQSIsImZpbGUiOiJhY3Rpdml0aWVzL2Jsb2NrLmpzIiwic291cmNlUm9vdCI6ImxpYi9lczYiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgQWN0aXZpdHkgPSByZXF1aXJlKFwiLi9hY3Rpdml0eVwiKTtcclxudmFyIHV0aWwgPSByZXF1aXJlKFwidXRpbFwiKTtcclxudmFyIERlY2xhcmF0b3IgPSByZXF1aXJlKFwiLi9kZWNsYXJhdG9yXCIpO1xyXG5cclxuZnVuY3Rpb24gQmxvY2soKSB7XHJcbiAgICBEZWNsYXJhdG9yLmNhbGwodGhpcyk7XHJcbn1cclxuXHJcbnV0aWwuaW5oZXJpdHMoQmxvY2ssIERlY2xhcmF0b3IpO1xyXG5cclxuQmxvY2sucHJvdG90eXBlLnZhcnNEZWNsYXJlZCA9IGZ1bmN0aW9uIChjYWxsQ29udGV4dCwgYXJncykge1xyXG4gICAgdmFyIHRvZG8gPSBbXTtcclxuICAgIHRoaXMuc2V0KFwiX3RvZG9cIiwgdG9kbyk7XHJcbiAgICBpZiAoYXJncy5sZW5ndGgpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gYXJncy5sZW5ndGggLSAxOyBpID49IDE7IGktLSkge1xyXG4gICAgICAgICAgICB0b2RvLnB1c2goYXJnc1tpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhbGxDb250ZXh0LnNjaGVkdWxlKGFyZ3NbMF0sIFwiX2FyZ0dvdFwiKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGNhbGxDb250ZXh0LmVuZChBY3Rpdml0eS5zdGF0ZXMuY29tcGxldGUsIG51bGwpO1xyXG4gICAgfVxyXG59XHJcblxyXG5CbG9jay5wcm90b3R5cGUuX2FyZ0dvdCA9IGZ1bmN0aW9uIChjYWxsQ29udGV4dCwgcmVhc29uLCByZXN1bHQpIHtcclxuICAgIHZhciB0b2RvID0gdGhpcy5nZXQoXCJfdG9kb1wiKTtcclxuICAgIGlmIChyZWFzb24gPT09IEFjdGl2aXR5LnN0YXRlcy5jb21wbGV0ZSkge1xyXG4gICAgICAgIGlmICh0b2RvLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICBjYWxsQ29udGV4dC5jb21wbGV0ZShyZXN1bHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY2FsbENvbnRleHQuc2NoZWR1bGUodG9kby5wb3AoKSwgXCJfYXJnR290XCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGNhbGxDb250ZXh0LmVuZChyZWFzb24sIHJlc3VsdCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gQmxvY2s7Il19
