"use strict";
"use strict";
var Activity = require("./activity");
var util = require("util");
var _ = require("lodash");
function Expression() {
  Activity.call(this);
  this.expr = null;
  this.nonSerializedProperties.add("_f");
}
util.inherits(Expression, Activity);
Expression.prototype.run = function(callContext, args) {
  var self = this;
  var expr = self.get("expr");
  if (expr) {
    try {
      var f = self.get("_f");
      if (!f) {
        f = self.set("_f", new Function("_", "return (" + expr + ")"));
      }
      callContext.complete(f.call(self, _));
    } catch (e) {
      callContext.fail(e);
    }
  } else {
    callContext.complete(null);
  }
};
module.exports = Expression;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4cHJlc3Npb24uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0E7QUFBQSxXQUFXLENBQUM7QUFFWixBQUFJLEVBQUEsQ0FBQSxRQUFPLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxZQUFXLENBQUMsQ0FBQztBQUNwQyxBQUFJLEVBQUEsQ0FBQSxJQUFHLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxNQUFLLENBQUMsQ0FBQztBQUMxQixBQUFJLEVBQUEsQ0FBQSxDQUFBLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxRQUFPLENBQUMsQ0FBQztBQUV6QixPQUFTLFdBQVMsQ0FBRSxBQUFELENBQUc7QUFDbEIsU0FBTyxLQUFLLEFBQUMsQ0FBQyxJQUFHLENBQUMsQ0FBQztBQUNuQixLQUFHLEtBQUssRUFBSSxLQUFHLENBQUM7QUFDaEIsS0FBRyx3QkFBd0IsSUFBSSxBQUFDLENBQUMsSUFBRyxDQUFDLENBQUM7QUFDMUM7QUFBQSxBQUVBLEdBQUcsU0FBUyxBQUFDLENBQUMsVUFBUyxDQUFHLFNBQU8sQ0FBQyxDQUFDO0FBRW5DLFNBQVMsVUFBVSxJQUFJLEVBQUksVUFBVSxXQUFVLENBQUcsQ0FBQSxJQUFHLENBQUc7QUFDcEQsQUFBSSxJQUFBLENBQUEsSUFBRyxFQUFJLEtBQUcsQ0FBQztBQUNmLEFBQUksSUFBQSxDQUFBLElBQUcsRUFBSSxDQUFBLElBQUcsSUFBSSxBQUFDLENBQUMsTUFBSyxDQUFDLENBQUM7QUFDM0IsS0FBSSxJQUFHLENBQUc7QUFDTixNQUFJO0FBQ0EsQUFBSSxRQUFBLENBQUEsQ0FBQSxFQUFJLENBQUEsSUFBRyxJQUFJLEFBQUMsQ0FBQyxJQUFHLENBQUMsQ0FBQztBQUN0QixTQUFJLENBQUMsQ0FBQSxDQUFHO0FBQ0osUUFBQSxFQUFJLENBQUEsSUFBRyxJQUFJLEFBQUMsQ0FBQyxJQUFHLENBQUcsSUFBSSxTQUFPLEFBQUMsQ0FBQyxHQUFFLENBQUcsQ0FBQSxVQUFTLEVBQUksS0FBRyxDQUFBLENBQUksSUFBRSxDQUFDLENBQUMsQ0FBQztNQUNsRTtBQUFBLEFBQ0EsZ0JBQVUsU0FBUyxBQUFDLENBQUMsQ0FBQSxLQUFLLEFBQUMsQ0FBQyxJQUFHLENBQUcsRUFBQSxDQUFDLENBQUMsQ0FBQztJQUN6QyxDQUNBLE9BQU0sQ0FBQSxDQUFHO0FBQ0wsZ0JBQVUsS0FBSyxBQUFDLENBQUMsQ0FBQSxDQUFDLENBQUM7SUFDdkI7QUFBQSxFQUNKLEtBQ0s7QUFDRCxjQUFVLFNBQVMsQUFBQyxDQUFDLElBQUcsQ0FBQyxDQUFDO0VBQzlCO0FBQUEsQUFDSixDQUFDO0FBRUQsS0FBSyxRQUFRLEVBQUksV0FBUyxDQUFDO0FBQzNCIiwiZmlsZSI6ImFjdGl2aXRpZXMvZXhwcmVzc2lvbi5qcyIsInNvdXJjZVJvb3QiOiJsaWIvZXM2Iiwic291cmNlc0NvbnRlbnQiOlsiLyoganNoaW50IC1XMDU0Ki9cblwidXNlIHN0cmljdFwiO1xuXG5sZXQgQWN0aXZpdHkgPSByZXF1aXJlKFwiLi9hY3Rpdml0eVwiKTtcbmxldCB1dGlsID0gcmVxdWlyZShcInV0aWxcIik7XG5sZXQgXyA9IHJlcXVpcmUoXCJsb2Rhc2hcIik7XG5cbmZ1bmN0aW9uIEV4cHJlc3Npb24oKSB7XG4gICAgQWN0aXZpdHkuY2FsbCh0aGlzKTtcbiAgICB0aGlzLmV4cHIgPSBudWxsO1xuICAgIHRoaXMubm9uU2VyaWFsaXplZFByb3BlcnRpZXMuYWRkKFwiX2ZcIik7XG59XG5cbnV0aWwuaW5oZXJpdHMoRXhwcmVzc2lvbiwgQWN0aXZpdHkpO1xuXG5FeHByZXNzaW9uLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoY2FsbENvbnRleHQsIGFyZ3MpIHtcbiAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgbGV0IGV4cHIgPSBzZWxmLmdldChcImV4cHJcIik7XG4gICAgaWYgKGV4cHIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCBmID0gc2VsZi5nZXQoXCJfZlwiKTtcbiAgICAgICAgICAgIGlmICghZikge1xuICAgICAgICAgICAgICAgIGYgPSBzZWxmLnNldChcIl9mXCIsIG5ldyBGdW5jdGlvbihcIl9cIiwgXCJyZXR1cm4gKFwiICsgZXhwciArIFwiKVwiKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYWxsQ29udGV4dC5jb21wbGV0ZShmLmNhbGwoc2VsZiwgXykpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoKGUpIHtcbiAgICAgICAgICAgIGNhbGxDb250ZXh0LmZhaWwoZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNhbGxDb250ZXh0LmNvbXBsZXRlKG51bGwpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gRXhwcmVzc2lvbjtcbiJdfQ==
