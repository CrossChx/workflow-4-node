"use strict";
var Activity = require("./activity");
var util = require("util");
var fast = require("fast.js");
function Expression() {
  Activity.call(this);
  this.expr = null;
  this.nonSerializedProperties.add("_f");
}
util.inherits(Expression, Activity);
Expression.prototype.run = function(callContext, args) {
  var self = this;
  var expr = self.get("expr");
  if (expr) {
    var e = fast.try(function() {
      var f = self.get("_f");
      if (!f) {
        f = self.set("_f", new Function("return (" + expr + ")"));
      }
      callContext.complete(f.call(self));
    });
    if (e instanceof Error)
      callContext.fail(e);
  } else {
    callContext.complete(null);
  }
};
module.exports = Expression;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4cHJlc3Npb24uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQSxBQUFJLEVBQUEsQ0FBQSxRQUFPLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxZQUFXLENBQUMsQ0FBQztBQUNwQyxBQUFJLEVBQUEsQ0FBQSxJQUFHLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxNQUFLLENBQUMsQ0FBQztBQUMxQixBQUFJLEVBQUEsQ0FBQSxJQUFHLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxTQUFRLENBQUMsQ0FBQztBQUU3QixPQUFTLFdBQVMsQ0FBRSxBQUFELENBQUc7QUFDbEIsU0FBTyxLQUFLLEFBQUMsQ0FBQyxJQUFHLENBQUMsQ0FBQztBQUNuQixLQUFHLEtBQUssRUFBSSxLQUFHLENBQUM7QUFDaEIsS0FBRyx3QkFBd0IsSUFBSSxBQUFDLENBQUMsSUFBRyxDQUFDLENBQUM7QUFDMUM7QUFBQSxBQUVBLEdBQUcsU0FBUyxBQUFDLENBQUMsVUFBUyxDQUFHLFNBQU8sQ0FBQyxDQUFDO0FBRW5DLFNBQVMsVUFBVSxJQUFJLEVBQUksVUFBVSxXQUFVLENBQUcsQ0FBQSxJQUFHLENBQUc7QUFDcEQsQUFBSSxJQUFBLENBQUEsSUFBRyxFQUFJLEtBQUcsQ0FBQztBQUNmLEFBQUksSUFBQSxDQUFBLElBQUcsRUFBSSxDQUFBLElBQUcsSUFBSSxBQUFDLENBQUMsTUFBSyxDQUFDLENBQUM7QUFDM0IsS0FBSSxJQUFHLENBQUc7QUFDTixBQUFJLE1BQUEsQ0FBQSxDQUFBLEVBQUksQ0FBQSxJQUFHLElBQUksQUFBQyxDQUFDLFNBQVUsQUFBRCxDQUFHO0FBQ3pCLEFBQUksUUFBQSxDQUFBLENBQUEsRUFBSSxDQUFBLElBQUcsSUFBSSxBQUFDLENBQUMsSUFBRyxDQUFDLENBQUM7QUFDdEIsU0FBSSxDQUFDLENBQUEsQ0FBRztBQUNKLFFBQUEsRUFBSSxDQUFBLElBQUcsSUFBSSxBQUFDLENBQUMsSUFBRyxDQUFHLElBQUksU0FBTyxBQUFDLENBQUMsVUFBUyxFQUFJLEtBQUcsQ0FBQSxDQUFJLElBQUUsQ0FBQyxDQUFDLENBQUM7TUFDN0Q7QUFBQSxBQUNBLGdCQUFVLFNBQVMsQUFBQyxDQUFDLENBQUEsS0FBSyxBQUFDLENBQUMsSUFBRyxDQUFDLENBQUMsQ0FBQztJQUN0QyxDQUFDLENBQUM7QUFFRixPQUFJLENBQUEsV0FBYSxNQUFJO0FBQUcsZ0JBQVUsS0FBSyxBQUFDLENBQUMsQ0FBQSxDQUFDLENBQUM7QUFBQSxFQUMvQyxLQUNLO0FBQ0QsY0FBVSxTQUFTLEFBQUMsQ0FBQyxJQUFHLENBQUMsQ0FBQztFQUM5QjtBQUFBLEFBQ0osQ0FBQTtBQUVBLEtBQUssUUFBUSxFQUFJLFdBQVMsQ0FBQztBQUMzQiIsImZpbGUiOiJhY3Rpdml0aWVzL2V4cHJlc3Npb24uanMiLCJzb3VyY2VSb290IjoibGliL2VzNiIsInNvdXJjZXNDb250ZW50IjpbInZhciBBY3Rpdml0eSA9IHJlcXVpcmUoXCIuL2FjdGl2aXR5XCIpO1xyXG52YXIgdXRpbCA9IHJlcXVpcmUoXCJ1dGlsXCIpO1xyXG52YXIgZmFzdCA9IHJlcXVpcmUoXCJmYXN0LmpzXCIpO1xyXG5cclxuZnVuY3Rpb24gRXhwcmVzc2lvbigpIHtcclxuICAgIEFjdGl2aXR5LmNhbGwodGhpcyk7XHJcbiAgICB0aGlzLmV4cHIgPSBudWxsO1xyXG4gICAgdGhpcy5ub25TZXJpYWxpemVkUHJvcGVydGllcy5hZGQoXCJfZlwiKTtcclxufVxyXG5cclxudXRpbC5pbmhlcml0cyhFeHByZXNzaW9uLCBBY3Rpdml0eSk7XHJcblxyXG5FeHByZXNzaW9uLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoY2FsbENvbnRleHQsIGFyZ3MpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBleHByID0gc2VsZi5nZXQoXCJleHByXCIpO1xyXG4gICAgaWYgKGV4cHIpIHtcclxuICAgICAgICB2YXIgZSA9IGZhc3QudHJ5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGYgPSBzZWxmLmdldChcIl9mXCIpO1xyXG4gICAgICAgICAgICBpZiAoIWYpIHtcclxuICAgICAgICAgICAgICAgIGYgPSBzZWxmLnNldChcIl9mXCIsIG5ldyBGdW5jdGlvbihcInJldHVybiAoXCIgKyBleHByICsgXCIpXCIpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYWxsQ29udGV4dC5jb21wbGV0ZShmLmNhbGwoc2VsZikpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEVycm9yKSBjYWxsQ29udGV4dC5mYWlsKGUpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgY2FsbENvbnRleHQuY29tcGxldGUobnVsbCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gRXhwcmVzc2lvbjtcclxuIl19
