"use strict";
"use strict";
var _ = require("lodash");
var is = require("../common/is");
function InstanceIdParser() {
  this._cache = {};
}
InstanceIdParser.prototype.parse = function(path, obj) {
  if (!obj) {
    throw new Error("Argument 'obj' expected.");
  }
  if (!_(path).isString()) {
    throw new TypeError("Argument 'path' is not a string.");
  }
  var parser = this._cache[path];
  if (is.undefined(parser)) {
    this._cache[path] = parser = this._createParser(path);
  }
  return parser.call(obj);
};
InstanceIdParser.prototype._createParser = function(path) {
  if (path.indexOf("this") !== 0) {
    if (path[0] === "[") {
      path = "this" + path;
    } else {
      path = "this." + path;
    }
  }
  return new Function("return (" + path + ").toString();");
};
module.exports = InstanceIdParser;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluc3RhbmNlSWRQYXJzZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0E7QUFBQSxXQUFXLENBQUM7QUFFWixBQUFJLEVBQUEsQ0FBQSxDQUFBLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxRQUFPLENBQUMsQ0FBQztBQUN6QixBQUFJLEVBQUEsQ0FBQSxFQUFDLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxjQUFhLENBQUMsQ0FBQztBQUVoQyxPQUFTLGlCQUFlLENBQUUsQUFBRCxDQUFHO0FBQ3hCLEtBQUcsT0FBTyxFQUFJLEdBQUMsQ0FBQztBQUNwQjtBQUFBLEFBRUEsZUFBZSxVQUFVLE1BQU0sRUFBSSxVQUFVLElBQUcsQ0FBRyxDQUFBLEdBQUUsQ0FBRztBQUNwRCxLQUFJLENBQUMsR0FBRSxDQUFHO0FBQ04sUUFBTSxJQUFJLE1BQUksQUFBQyxDQUFDLDBCQUF5QixDQUFDLENBQUM7RUFDL0M7QUFBQSxBQUNBLEtBQUksQ0FBQyxDQUFBLEFBQUMsQ0FBQyxJQUFHLENBQUMsU0FBUyxBQUFDLEVBQUMsQ0FBRztBQUNyQixRQUFNLElBQUksVUFBUSxBQUFDLENBQUMsa0NBQWlDLENBQUMsQ0FBQztFQUMzRDtBQUFBLEFBRUksSUFBQSxDQUFBLE1BQUssRUFBSSxDQUFBLElBQUcsT0FBTyxDQUFFLElBQUcsQ0FBQyxDQUFDO0FBQzlCLEtBQUksRUFBQyxVQUFVLEFBQUMsQ0FBQyxNQUFLLENBQUMsQ0FBRztBQUN0QixPQUFHLE9BQU8sQ0FBRSxJQUFHLENBQUMsRUFBSSxDQUFBLE1BQUssRUFBSSxDQUFBLElBQUcsY0FBYyxBQUFDLENBQUMsSUFBRyxDQUFDLENBQUM7RUFDekQ7QUFBQSxBQUVBLE9BQU8sQ0FBQSxNQUFLLEtBQUssQUFBQyxDQUFDLEdBQUUsQ0FBQyxDQUFDO0FBQzNCLENBQUM7QUFFRCxlQUFlLFVBQVUsY0FBYyxFQUFJLFVBQVUsSUFBRyxDQUFHO0FBQ3ZELEtBQUksSUFBRyxRQUFRLEFBQUMsQ0FBQyxNQUFLLENBQUMsQ0FBQSxHQUFNLEVBQUEsQ0FBRztBQUM1QixPQUFJLElBQUcsQ0FBRSxDQUFBLENBQUMsSUFBTSxJQUFFLENBQUc7QUFDakIsU0FBRyxFQUFJLENBQUEsTUFBSyxFQUFJLEtBQUcsQ0FBQztJQUN4QixLQUNLO0FBQ0QsU0FBRyxFQUFJLENBQUEsT0FBTSxFQUFJLEtBQUcsQ0FBQztJQUN6QjtBQUFBLEVBQ0o7QUFBQSxBQUVBLE9BQU8sSUFBSSxTQUFPLEFBQUMsQ0FBQyxVQUFTLEVBQUksS0FBRyxDQUFBLENBQUksZ0JBQWMsQ0FBQyxDQUFDO0FBQzVELENBQUM7QUFFRCxLQUFLLFFBQVEsRUFBSSxpQkFBZSxDQUFDO0FBQ2pDIiwiZmlsZSI6Imhvc3RpbmcvaW5zdGFuY2VJZFBhcnNlci5qcyIsInNvdXJjZVJvb3QiOiJsaWIvZXM2Iiwic291cmNlc0NvbnRlbnQiOlsiLyoganNoaW50IC1XMDU0Ki9cblwidXNlIHN0cmljdFwiO1xuXG5sZXQgXyA9IHJlcXVpcmUoXCJsb2Rhc2hcIik7XG5sZXQgaXMgPSByZXF1aXJlKFwiLi4vY29tbW9uL2lzXCIpO1xuXG5mdW5jdGlvbiBJbnN0YW5jZUlkUGFyc2VyKCkge1xuICAgIHRoaXMuX2NhY2hlID0ge307XG59XG5cbkluc3RhbmNlSWRQYXJzZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKHBhdGgsIG9iaikge1xuICAgIGlmICghb2JqKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFyZ3VtZW50ICdvYmonIGV4cGVjdGVkLlwiKTtcbiAgICB9XG4gICAgaWYgKCFfKHBhdGgpLmlzU3RyaW5nKCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkFyZ3VtZW50ICdwYXRoJyBpcyBub3QgYSBzdHJpbmcuXCIpO1xuICAgIH1cblxuICAgIGxldCBwYXJzZXIgPSB0aGlzLl9jYWNoZVtwYXRoXTtcbiAgICBpZiAoaXMudW5kZWZpbmVkKHBhcnNlcikpIHtcbiAgICAgICAgdGhpcy5fY2FjaGVbcGF0aF0gPSBwYXJzZXIgPSB0aGlzLl9jcmVhdGVQYXJzZXIocGF0aCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhcnNlci5jYWxsKG9iaik7XG59O1xuXG5JbnN0YW5jZUlkUGFyc2VyLnByb3RvdHlwZS5fY3JlYXRlUGFyc2VyID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICBpZiAocGF0aC5pbmRleE9mKFwidGhpc1wiKSAhPT0gMCkge1xuICAgICAgICBpZiAocGF0aFswXSA9PT0gXCJbXCIpIHtcbiAgICAgICAgICAgIHBhdGggPSBcInRoaXNcIiArIHBhdGg7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwYXRoID0gXCJ0aGlzLlwiICsgcGF0aDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBuZXcgRnVuY3Rpb24oXCJyZXR1cm4gKFwiICsgcGF0aCArIFwiKS50b1N0cmluZygpO1wiKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gSW5zdGFuY2VJZFBhcnNlcjtcbiJdfQ==
