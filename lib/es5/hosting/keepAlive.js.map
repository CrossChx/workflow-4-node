{"version":3,"sources":["hosting/keepAlive.js"],"names":[],"mappings":";;AAAA,IAAI,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;AAC1B,IAAI,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;;AAEnC,SAAS,SAAS,CAAC,UAAU,EAAE,YAAY,EAAE;AACzC,QAAI,CAAC,CAAC,CAAC,UAAU,CAAC,UAAU,CAAC,EAAE,MAAM,IAAI,SAAS,CAAC,6BAA6B,CAAC,CAAC;AAClF,QAAI,CAAC,WAAW,GAAG,UAAU,CAAC;AAC9B,QAAI,CAAC,aAAa,GAAG,YAAY,CAAC;AAClC,QAAI,CAAC,UAAU,GAAG,IAAI,CAAC;AACvB,QAAI,CAAC,KAAK,GAAG,IAAI,CAAC;AAClB,QAAI,IAAI,GAAG,IAAI,CAAC;AAChB,WAAO,CAAC,QAAQ,CAAC,YAAY;AACzB,YAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAC1B,CAAC,CAAC;CACN;;AAED,SAAS,CAAC,SAAS,CAAC,MAAM,GAAG,YAAY;AACrC,QAAI,IAAI,GAAG,IAAI,CAAC;AAChB,QAAI,CAAC,KAAK,GAAG,UAAU,CACnB,YAAY;AACR,YAAI,IAAI,CAAC,UAAU,EAAE;AACjB,oBAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,CAC/B,KAAK,CAAC,UAAU,CAAC,EAAE;AAChB,uBAAO,CAAC,KAAK,CAAC,sBAAsB,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC;aACnD,CAAC,CACD,OAAO,CAAC,YAAY;AACjB,oBAAI,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC;aACtC,CAAC,CAAC;SACV;KACJ,EACD,IAAI,CAAC,aAAa,CAAC,CAAC;CAC3B,CAAA;;AAED,SAAS,CAAC,SAAS,CAAC,GAAG,GAAG,YAAY;AAClC,QAAI,CAAC,IAAI,CAAC,UAAU,EAAE,MAAM,IAAI,KAAK,CAAC,+BAA+B,CAAC,CAAC;;AAEvE,QAAI,CAAC,UAAU,GAAG,KAAK,CAAC;AACxB,QAAI,IAAI,CAAC,KAAK,EAAE,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;CAC5C,CAAA;;AAED,MAAM,CAAC,OAAO,GAAG,SAAS,CAAC","file":"hosting/keepAlive.js","sourcesContent":["var _ = require(\"lodash\");\nvar Bluebird = require(\"bluebird\");\n\nfunction KeepAlive(repeatFunc, repeatPeriod) {\n    if (!_.isFunction(repeatFunc)) throw new TypeError(\"Function argument expected.\");\n    this._repeatFunc = repeatFunc;\n    this._repeatPeriod = repeatPeriod;\n    this._isRunning = true;\n    this._toId = null;\n    var self = this;\n    process.nextTick(function () {\n        self._start.call(self);\n    });\n}\n\nKeepAlive.prototype._start = function () {\n    var self = this;\n    self._toId = setTimeout(\n        function () {\n            if (self._isRunning) {\n                Bluebird.resolve(self._repeatFunc())\n                    .catch(function (e) {\n                        console.error(\"Keep alive failed:\\n\" + e.stack);\n                    })\n                    .finally(function () {\n                        if (self._isRunning) self._start();\n                    });\n            }\n        },\n        self._repeatPeriod);\n}\n\nKeepAlive.prototype.end = function () {\n    if (!this._isRunning) throw new Error(\"Keep alive has already ended.\");\n\n    this._isRunning = false;\n    if (this._toId) clearTimeout(this._toId);\n}\n\nmodule.exports = KeepAlive;"],"sourceRoot":"/source/"}