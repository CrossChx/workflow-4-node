"use strict";
var Activity = require("./activity");
var util = require("util");
var fast = require("fast.js");
function Expression() {
  Activity.call(this);
  this.expr = null;
  this.nonSerializedProperties.add("_f");
}
util.inherits(Expression, Activity);
Expression.prototype.run = function(callContext, args) {
  var self = this;
  var expr = self.get("expr");
  if (expr) {
    var e = fast.try(function() {
      var f = self.get("_f");
      if (!f) {
        f = self.set("_f", new Function("return (" + expr + ")"));
      }
      callContext.complete(f.call(self));
    });
    if (e instanceof Error)
      callContext.fail(e);
  } else {
    callContext.complete(null);
  }
};
module.exports = Expression;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4cHJlc3Npb24uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQSxBQUFJLEVBQUEsQ0FBQSxRQUFPLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxZQUFXLENBQUMsQ0FBQztBQUNwQyxBQUFJLEVBQUEsQ0FBQSxJQUFHLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxNQUFLLENBQUMsQ0FBQztBQUMxQixBQUFJLEVBQUEsQ0FBQSxJQUFHLEVBQUksQ0FBQSxPQUFNLEFBQUMsQ0FBQyxTQUFRLENBQUMsQ0FBQztBQUU3QixPQUFTLFdBQVMsQ0FBRSxBQUFELENBQUc7QUFDbEIsU0FBTyxLQUFLLEFBQUMsQ0FBQyxJQUFHLENBQUMsQ0FBQztBQUNuQixLQUFHLEtBQUssRUFBSSxLQUFHLENBQUM7QUFDaEIsS0FBRyx3QkFBd0IsSUFBSSxBQUFDLENBQUMsSUFBRyxDQUFDLENBQUM7QUFDMUM7QUFBQSxBQUVBLEdBQUcsU0FBUyxBQUFDLENBQUMsVUFBUyxDQUFHLFNBQU8sQ0FBQyxDQUFDO0FBRW5DLFNBQVMsVUFBVSxJQUFJLEVBQUksVUFBVSxXQUFVLENBQUcsQ0FBQSxJQUFHLENBQUc7QUFDcEQsQUFBSSxJQUFBLENBQUEsSUFBRyxFQUFJLEtBQUcsQ0FBQztBQUNmLEFBQUksSUFBQSxDQUFBLElBQUcsRUFBSSxDQUFBLElBQUcsSUFBSSxBQUFDLENBQUMsTUFBSyxDQUFDLENBQUM7QUFDM0IsS0FBSSxJQUFHLENBQUc7QUFDTixBQUFJLE1BQUEsQ0FBQSxDQUFBLEVBQUksQ0FBQSxJQUFHLElBQUksQUFBQyxDQUFDLFNBQVUsQUFBRCxDQUFHO0FBQ3pCLEFBQUksUUFBQSxDQUFBLENBQUEsRUFBSSxDQUFBLElBQUcsSUFBSSxBQUFDLENBQUMsSUFBRyxDQUFDLENBQUM7QUFDdEIsU0FBSSxDQUFDLENBQUEsQ0FBRztBQUNKLFFBQUEsRUFBSSxDQUFBLElBQUcsSUFBSSxBQUFDLENBQUMsSUFBRyxDQUFHLElBQUksU0FBTyxBQUFDLENBQUMsVUFBUyxFQUFJLEtBQUcsQ0FBQSxDQUFJLElBQUUsQ0FBQyxDQUFDLENBQUM7TUFDN0Q7QUFBQSxBQUNBLGdCQUFVLFNBQVMsQUFBQyxDQUFDLENBQUEsS0FBSyxBQUFDLENBQUMsSUFBRyxDQUFDLENBQUMsQ0FBQztJQUN0QyxDQUFDLENBQUM7QUFFRixPQUFJLENBQUEsV0FBYSxNQUFJO0FBQUcsZ0JBQVUsS0FBSyxBQUFDLENBQUMsQ0FBQSxDQUFDLENBQUM7QUFBQSxFQUMvQyxLQUNLO0FBQ0QsY0FBVSxTQUFTLEFBQUMsQ0FBQyxJQUFHLENBQUMsQ0FBQztFQUM5QjtBQUFBLEFBQ0osQ0FBQTtBQUVBLEtBQUssUUFBUSxFQUFJLFdBQVMsQ0FBQztBQUMzQiIsImZpbGUiOiJhY3Rpdml0aWVzL2V4cHJlc3Npb24uanMiLCJzb3VyY2VSb290IjoiQzovR0lUL21vbmdvLWNydW5jaC9kZXBzL3dvcmtmbG93LTQtbm9kZS9saWIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIEFjdGl2aXR5ID0gcmVxdWlyZShcIi4vYWN0aXZpdHlcIik7XHJcbnZhciB1dGlsID0gcmVxdWlyZShcInV0aWxcIik7XHJcbnZhciBmYXN0ID0gcmVxdWlyZShcImZhc3QuanNcIik7XHJcblxyXG5mdW5jdGlvbiBFeHByZXNzaW9uKCkge1xyXG4gICAgQWN0aXZpdHkuY2FsbCh0aGlzKTtcclxuICAgIHRoaXMuZXhwciA9IG51bGw7XHJcbiAgICB0aGlzLm5vblNlcmlhbGl6ZWRQcm9wZXJ0aWVzLmFkZChcIl9mXCIpO1xyXG59XHJcblxyXG51dGlsLmluaGVyaXRzKEV4cHJlc3Npb24sIEFjdGl2aXR5KTtcclxuXHJcbkV4cHJlc3Npb24ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uIChjYWxsQ29udGV4dCwgYXJncykge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIGV4cHIgPSBzZWxmLmdldChcImV4cHJcIik7XHJcbiAgICBpZiAoZXhwcikge1xyXG4gICAgICAgIHZhciBlID0gZmFzdC50cnkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZiA9IHNlbGYuZ2V0KFwiX2ZcIik7XHJcbiAgICAgICAgICAgIGlmICghZikge1xyXG4gICAgICAgICAgICAgICAgZiA9IHNlbGYuc2V0KFwiX2ZcIiwgbmV3IEZ1bmN0aW9uKFwicmV0dXJuIChcIiArIGV4cHIgKyBcIilcIikpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhbGxDb250ZXh0LmNvbXBsZXRlKGYuY2FsbChzZWxmKSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgRXJyb3IpIGNhbGxDb250ZXh0LmZhaWwoZSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBjYWxsQ29udGV4dC5jb21wbGV0ZShudWxsKTtcclxuICAgIH1cclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBFeHByZXNzaW9uO1xyXG4iXX0=
